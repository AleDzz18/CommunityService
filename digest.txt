Directory structure:
â””â”€â”€ aledzz18-communityservice/
    â”œâ”€â”€ README.md
    â”œâ”€â”€ manage.py
    â”œâ”€â”€ requirements.txt
    â”œâ”€â”€ App_Home/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ admin.py
    â”‚   â”œâ”€â”€ apps.py
    â”‚   â”œâ”€â”€ forms.py
    â”‚   â”œâ”€â”€ models.py
    â”‚   â”œâ”€â”€ tests.py
    â”‚   â”œâ”€â”€ urls.py
    â”‚   â”œâ”€â”€ views.py
    â”‚   â”œâ”€â”€ static/
    â”‚   â”‚   â”œâ”€â”€ css/
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-HD.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-lidergeneral.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-listado.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-login.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-navbar.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ styles-perfil.css
    â”‚   â”‚   â”‚   â””â”€â”€ material-theme/
    â”‚   â”‚   â”‚       â”œâ”€â”€ dark-hc.css
    â”‚   â”‚   â”‚       â”œâ”€â”€ dark-mc.css
    â”‚   â”‚   â”‚       â”œâ”€â”€ dark.css
    â”‚   â”‚   â”‚       â”œâ”€â”€ light-hc.css
    â”‚   â”‚   â”‚       â”œâ”€â”€ light-mc.css
    â”‚   â”‚   â”‚       â””â”€â”€ light.css
    â”‚   â”‚   â””â”€â”€ js/
    â”‚   â”‚       â”œâ”€â”€ scripts-HD.js
    â”‚   â”‚       â””â”€â”€ scripts-login.js
    â”‚   â””â”€â”€ templates/
    â”‚       â”œâ”€â”€ completar_perfil.html
    â”‚       â”œâ”€â”€ homeDashboard.html
    â”‚       â”œâ”€â”€ login.html
    â”‚       â”œâ”€â”€ finanzas/
    â”‚       â”‚   â””â”€â”€ listado_movimientos.html
    â”‚       â””â”€â”€ layouts/
    â”‚           â”œâ”€â”€ base.html
    â”‚           â””â”€â”€ navbar.html
    â”œâ”€â”€ App_LiderGeneral/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ admin.py
    â”‚   â”œâ”€â”€ apps.py
    â”‚   â”œâ”€â”€ forms.py
    â”‚   â”œâ”€â”€ models.py
    â”‚   â”œâ”€â”€ tests.py
    â”‚   â”œâ”€â”€ urls.py
    â”‚   â”œâ”€â”€ views.py
    â”‚   â””â”€â”€ templates/
    â”‚       â””â”€â”€ lider_general/
    â”‚           â”œâ”€â”€ lista_usuarios.html
    â”‚           â”œâ”€â”€ usuario_confirm_delete.html
    â”‚           â””â”€â”€ usuario_form.html
    â”œâ”€â”€ App_LiderTorre/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ admin.py
    â”‚   â”œâ”€â”€ apps.py
    â”‚   â”œâ”€â”€ forms.py
    â”‚   â”œâ”€â”€ mixins.py
    â”‚   â”œâ”€â”€ models.py
    â”‚   â”œâ”€â”€ tests.py
    â”‚   â”œâ”€â”€ urls.py
    â”‚   â”œâ”€â”€ views.py
    â”‚   â””â”€â”€ templates/
    â”‚       â””â”€â”€ lider_torre/
    â”‚           â””â”€â”€ movimiento_form.html
    â””â”€â”€ Community_Service/
        â”œâ”€â”€ __init__.py
        â”œâ”€â”€ asgi.py
        â”œâ”€â”€ settings.py
        â”œâ”€â”€ urls.py
        â””â”€â”€ wsgi.py

================================================
FILE: README.md
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8f in position 2207: character maps to <undefined>


================================================
FILE: manage.py
================================================
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'Community_Service.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()



================================================
FILE: requirements.txt
================================================
[Binary file]


================================================
FILE: App_Home/__init__.py
================================================
[Empty file]


================================================
FILE: App_Home/admin.py
================================================
# App_Home/admin.py

from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.db.models import Sum, F
from django.utils.html import format_html
from .models import CustomUser, Tower, MovimientoFinanciero


# Clase de administrador personalizada para CustomUser
class AdministradorUsuario(UserAdmin):
    # Campos que se mostrarÃƒÂ¡n en la lista de usuarios del Admin
    list_display = (
        'username', 'email', 'first_name', 'last_name', 'is_staff', 
        'rol', 'tower', # <--- Ã‚Â¡CORREGIDO! De 'torre' a 'tower'
        'is_active', 'mostrar_roles_secundarios'
    )
    
    # Campos que se podrÃƒÂ¡n editar/filtrar
    list_filter = ('is_staff', 'is_active', 'rol', 'tower', 'es_admin_basura', 'es_admin_clap', 'es_admin_bombonas')
    search_fields = ('username', 'first_name', 'last_name', 'email', 'cedula')
    ordering = ('username',)

    # Campos de roles secundarios combinados
    def mostrar_roles_secundarios(self, obj):
        roles = []
        if obj.es_admin_basura:
            roles.append("Basura")
        if obj.es_admin_clap:
            roles.append("CLAP")
        if obj.es_admin_bombonas:
            roles.append("Bombonas")
        
        if roles:
            return format_html('<span style="color: blue;">{}</span>', ", ".join(roles))
        return "-"
    mostrar_roles_secundarios.short_description = 'Roles Secundarios'
    
    # DefiniciÃƒÂ³n de Fieldsets (cÃƒÂ³mo se agrupan los campos en la vista de ediciÃƒÂ³n)
    fieldsets = UserAdmin.fieldsets + (
        ('InformaciÃƒÂ³n Personal Adicional', {'fields': ('cedula', 'apartamento', 'tower')}),
        ('Roles en la Comunidad', {'fields': ('rol', 'es_admin_basura', 'es_admin_clap', 'es_admin_bombonas')}),
    )

# ----------------------------------------------------
# Administrador para el modelo Tower
# ----------------------------------------------------
class AdministradorTower(admin.ModelAdmin):
    list_display = ('nombre', 'saldo_condominio', 'saldo_basura')
    search_fields = ('nombre',)
    ordering = ('nombre',)
    
    # AÃƒÂ±adir campos de saldo calculado
    def saldo_condominio(self, obj):
        return MovimientoFinanciero.calcular_saldo_condominio(tower=obj)
    saldo_condominio.short_description = 'Saldo Condominio'

    def saldo_basura(self, obj):
        return MovimientoFinanciero.calcular_saldo_basura(tower=obj)
    saldo_basura.short_description = 'Saldo Basura'
    
# ----------------------------------------------------
# Administrador para MovimientoFinanciero
# ----------------------------------------------------
class AdministradorMovimientoFinanciero(admin.ModelAdmin):
    list_display = ('fecha', 'descripcion', 'tipo', 'categoria', 'monto_total', 'tower', 'creado_por')
    list_filter = ('tipo', 'categoria', 'tower', 'creado_por')
    search_fields = ('descripcion',)
    date_hierarchy = 'fecha'
    ordering = ('-fecha',)
    
    # AÃƒÂ±adir una funciÃƒÂ³n para mostrar el monto total (suma de condominio y basura)
    def monto_total(self, obj):
        return obj.monto_condominio + obj.monto_basura
    monto_total.short_description = 'Monto Total'
    
    # Personalizar el formulario de ediciÃƒÂ³n/creaciÃƒÂ³n
    fieldsets = (
        (None, {'fields': ('fecha', 'descripcion', 'tipo', 'categoria', 'tower', 'creado_por')}),
        ('Montos', {'fields': ('monto_condominio', 'monto_basura')}),
    )
    
    # Auto-llenar el campo 'creado_por' con el usuario actual
    def save_model(self, request, obj, form, change):
        if not change:
            obj.creado_por = request.user
        super().save_model(request, obj, form, change)


# Registro de modelos en el administrador de Django
admin.site.register(CustomUser, AdministradorUsuario)
admin.site.register(Tower, AdministradorTower)
admin.site.register(MovimientoFinanciero, AdministradorMovimientoFinanciero)


================================================
FILE: App_Home/apps.py
================================================
from django.apps import AppConfig


class AppHomeConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'App_Home'



================================================
FILE: App_Home/forms.py
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x81 in position 2667: character maps to <undefined>


================================================
FILE: App_Home/models.py
================================================
# App_Home/models.py

from django.db import models
from django.contrib.auth.models import AbstractUser
from django.db.models.signals import post_migrate
from django.dispatch import receiver
from django.db.models import Sum # Necesario para la funciÃƒÂ³n de saldo
from django.db.utils import OperationalError # ImportaciÃƒÂ³n clave para manejar el error
from decimal import Decimal

# Modelo para las 24 Torres
class Tower(models.Model):
    nombre = models.CharField(max_length=50, unique=True, verbose_name='Nombre de la Torre')
    
    def __str__(self):
        return self.nombre  # Ejemplo: 'T01'
    
    class Meta:
        verbose_name = "Torre"
        verbose_name_plural = "Torres"
        ordering = ['nombre'] # Ordenar alfabÃƒÂ©ticamente

class MovimientoFinancieroManager(models.Manager):
    def calcular_saldo_torre(self, tower, categoria):
        """Calcula el saldo actual para una torre y categorÃƒÂ­a especÃƒÂ­fica."""
        
        # Determina el campo de monto a usar basado en la categorÃƒÂ­a
        monto_field = 'monto_condominio' if categoria == 'CON' else 'monto_basura'
        
        # Filtra por torre y categorÃƒÂ­a
        qs = self.filter(
            tower=tower, 
            categoria=categoria
        )

        # Suma los ingresos
        ingresos = qs.filter(tipo='ING').aggregate(total=Sum(monto_field))['total'] or Decimal('0.00')
        
        # Suma los egresos
        egresos = qs.filter(tipo='EGR').aggregate(total=Sum(monto_field))['total'] or Decimal('0.00')

        return ingresos - egresos
    
    def calcular_saldo_general_basura(self):
        """Calcula el saldo total de la categorÃƒÂ­a 'BASURA' (BAS) de TODAS las torres."""
        
        # El campo de monto a usar para la categorÃƒÂ­a Basura es 'monto_basura'
        monto_field = 'monto_basura'
        
        # Filtra solo por la categorÃƒÂ­a de Basura (BAS) de todas las torres
        qs = self.filter(categoria='BAS')

        # Suma los ingresos
        ingresos = qs.filter(tipo='ING').aggregate(total=Sum(monto_field))['total'] or Decimal(0)
        
        # Suma los egresos
        egresos = qs.filter(tipo='EGR').aggregate(total=Sum(monto_field))['total'] or Decimal(0)
        
        # Retorna el saldo total de la categorÃƒÂ­a 'BAS'
        return ingresos - egresos

# --- MODELO AÃƒâ€˜ADIDO: MOVIMIENTO FINANCIERO ---
class MovimientoFinanciero(models.Model):

    objects = MovimientoFinancieroManager()  # Asignar el Manager personalizado
    # Opciones de CategorÃƒÂ­a: Condominio General o Cuarto de Basura
    CATEGORIAS = [
        ('CON', 'Condominio'),
        ('BAS', 'Cuarto de Basura'),
    ]
    # Opciones de Tipo: Ingreso o Egreso
    TIPOS = [
        ('ING', 'Ingreso'),
        ('EGR', 'Egreso'),
    ]

    fecha = models.DateField(verbose_name='Fecha del Movimiento')
    descripcion = models.CharField(max_length=255, verbose_name='DescripciÃƒÂ³n')
    
    tasa_bcv = models.DecimalField(
        max_digits=10, 
        decimal_places=4, 
        verbose_name='Tasa BCV (Bs/USD)',
        # Se elimina null=True y blank=True para hacerlo obligatorio
        null=False, 
        blank=False,
        help_text="Tasa de referencia del BCV del dÃƒÂ­a en que se realizÃƒÂ³ el movimiento."
    )

    # Campos separados para mejor manejo en consultas
    monto_condominio = models.DecimalField(max_digits=10, decimal_places=2, default=0.00, verbose_name='Monto Condominio')
    monto_basura = models.DecimalField(max_digits=10, decimal_places=2, default=0.00, verbose_name='Monto Basura')
    
    tipo = models.CharField(max_length=3, choices=TIPOS, verbose_name='Tipo de Movimiento')
    categoria = models.CharField(max_length=3, choices=CATEGORIAS, verbose_name='CategorÃƒÂ­a')
    
    # RelaciÃƒÂ³n con la Torre (Si es un ingreso/egreso de una torre especÃƒÂ­fica)
    tower = models.ForeignKey(Tower, on_delete=models.CASCADE, null=True, blank=True, verbose_name='Torre Asociada')
    
    creado_por = models.ForeignKey('CustomUser', on_delete=models.SET_NULL, null=True, blank=True, verbose_name='Registrado por')

    def __str__(self):
        return f"{self.get_tipo_display()} - {self.get_categoria_display()} ({self.fecha})"
    
    class Meta:
        verbose_name = "Movimiento Financiero"
        verbose_name_plural = "Movimientos Financieros"
        ordering = ['-fecha', '-id']

    @staticmethod
    def calcular_saldo_condominio(tower=None):
        """Calcula el saldo total de Condominio, opcionalmente filtrado por Torre."""
        qs = MovimientoFinanciero.objects.filter(categoria='CON')
        if tower:
            qs = qs.filter(tower=tower)

        ingresos = qs.filter(tipo='ING').aggregate(total=Sum('monto_condominio'))['total'] or 0
        egresos = qs.filter(tipo='EGR').aggregate(total=Sum('monto_condominio'))['total'] or 0
        return ingresos - egresos

    @staticmethod
    def calcular_saldo_basura(tower=None):
        """Calcula el saldo total de Basura, opcionalmente filtrado por Torre."""
        qs = MovimientoFinanciero.objects.filter(categoria='BAS')
        if tower:
            qs = qs.filter(tower=tower)

        ingresos = qs.filter(tipo='ING').aggregate(total=Sum('monto_basura'))['total'] or 0
        egresos = qs.filter(tipo='EGR').aggregate(total=Sum('monto_basura'))['total'] or 0
        return ingresos - egresos


# --- MODELO PRINCIPAL: USUARIO PERSONALIZADO ---
class CustomUser(AbstractUser):
    
    # OPCIONES DE ROL
    ROL_LIDER_TORRE = 'LDT'
    ROL_LIDER_GENERAL = 'LDG'
    
    ROLES = [
        (ROL_LIDER_TORRE, 'LÃƒÂ­der de Torre'),
        (ROL_LIDER_GENERAL, 'LÃƒÂ­der General'),
    ]

    # CAMPOS PERSONALIZADOS
    cedula = models.CharField(max_length=15, unique=True, null=True, blank=True, verbose_name='CÃƒÂ©dula de Identidad')
    rol = models.CharField(max_length=3, choices=ROLES, default=ROL_LIDER_TORRE, verbose_name='Rol en la Comunidad')
    tower = models.ForeignKey(Tower, on_delete=models.SET_NULL, null=True, blank=True, verbose_name='Torre Asignada')
    apartamento = models.CharField(max_length=10, null=True, blank=True, verbose_name='Apartamento (Ej: P1-A)')

    # Campos de Roles Secundarios (Permisos)
    es_admin_basura = models.BooleanField(default=False, verbose_name='Administrador de Cuarto de Basura')
    es_admin_clap = models.BooleanField(default=False, verbose_name='Administrador de Bolsas CLAP')
    es_admin_bombonas = models.BooleanField(default=False, verbose_name='Administrador de Bombonas')
    
    def __str__(self):
        return self.username

    class Meta:
        verbose_name = "Usuario Personalizado"
        verbose_name_plural = "Usuarios Personalizados"

# ----------------------------------------------------
# SEÃƒâ€˜AL PARA CREAR TORRES INICIALES (CORREGIDA)
# ----------------------------------------------------
@receiver(post_migrate)
def crear_torres_iniciales(sender, apps, **kwargs): # AÃƒÂ±adimos 'apps' como argumento
    # Asegurarse de que el cÃƒÂ³digo se ejecute solo para esta aplicaciÃƒÂ³n
    if sender.name == 'App_Home':
        print("Verificando la creaciÃƒÂ³n de Torres iniciales (T01 a T24)...")
        
        # Obtenemos el modelo de Tower del estado actual de la BD
        try:
            Tower = apps.get_model('App_Home', 'Tower')
        except LookupError:
            return

        # Generar los nombres de las 24 torres (T01 a T24)
        nombres_torres = [f"T{i:02d}" for i in range(1, 25)]
        
        try:
            # LÃƒÂ³gica de creaciÃƒÂ³n de torres, envuelta en try-except
            torres_existentes = Tower.objects.values_list('nombre', flat=True)
            torres_a_crear = []
            
            for nombre in nombres_torres:
                if nombre not in torres_existentes:
                    torres_a_crear.append(Tower(nombre=nombre))
            
            if torres_a_crear:
                Tower.objects.bulk_create(torres_a_crear)
                print(f"Se crearon {len(torres_a_crear)} torres faltantes.")
            else:
                print("Todas las torres ya existen.")
        
        except OperationalError as e:
            # Capturamos el error especÃƒÂ­fico de tabla no existente y salimos limpiamente
            if 'no such table' in str(e):
                print(f"ADVERTENCIA: La tabla 'App_Home_tower' aÃƒÂºn no existe. La creaciÃƒÂ³n de torres se pospone hasta que se complete la migraciÃƒÂ³n.")
            else:
                raise e # Re-lanzar cualquier otro error
        except Exception as e:
            # Capturamos otros posibles errores de Django
            if 'no such table' in str(e):
                print(f"ADVERTENCIA: La tabla 'App_Home_tower' aÃƒÂºn no existe. La creaciÃƒÂ³n de torres se pospone hasta que se complete la migraciÃƒÂ³n.")
            else:
                raise e


================================================
FILE: App_Home/tests.py
================================================
from django.test import TestCase

# Create your tests here.



================================================
FILE: App_Home/urls.py
================================================
from django.urls import path
from . import views

urlpatterns = [
    path('', views.vista_dashboard, name='url_dashboard'),
    path('login/', views.vista_login, name='url_login'),
    path('logout/', views.vista_logout, name='url_logout'),
    path('register/', views.vista_registro, name='url_registro'),
    path('register/perfil/<int:user_id>/', views.vista_completar_perfil, name='url_completar_perfil'),
    
    # --- NUEVAS URLS: ADMINISTRACIÃƒâ€œN DE INGRESOS Y EGRESOS ---
    # Ejemplo de uso: /finanzas/condominio/ o /finanzas/basura/
    path('finanzas/<str:categoria_slug>/', views.ver_ingresos_egresos, name='ver_finanzas'),
    
    # URL para descargar el archivo PDF (ejemplo: /finanzas/condominio/descargar/)
    path('finanzas/<str:categoria_slug>/descargar/', views.descargar_pdf, name='descargar_pdf'),
]


================================================
FILE: App_Home/views.py
================================================
from django.shortcuts import render, redirect, get_object_or_404
from django.contrib.auth import authenticate, login as autenticar_login, logout
from django.contrib.auth.forms import AuthenticationForm
from django.contrib.auth.decorators import login_required 
from django.contrib import messages
from django.contrib.messages import get_messages
from django.http import HttpResponse # ImportaciÃ³n para manejar la respuesta de PDF
from django.utils import timezone # ImportaciÃ³n para manejar la fecha/hora actual
# Importaciones para generar PDF (Reportlab)
from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter, A4
from reportlab.lib import colors
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph # <-- CRÃTICO
from reportlab.lib.styles import getSampleStyleSheet # <-- CRÃTICO
from reportlab.lib.units import inch
from .forms import FormularioCreacionUsuario, FormularioPerfilUsuario, FormularioFiltroMovimientos 
from .models import CustomUser, Tower, MovimientoFinanciero # ImportaciÃ³n de los nuevos modelos
from decimal import Decimal

def vista_dashboard(request):
    """
    Muestra la pÃ¡gina principal o dashboard. Permite acceso a espectadores.
    """
    
    # ðŸ”‘ LÃ“GICA CRÃTICA: REDIRECCIÃ“N FORZOSA A COMPLETAR PERFIL
    if request.user.is_authenticated:
        usuario = request.user
        
        # Utilizamos la CÃ©dula (cedula) como el indicador principal de Perfil Incompleto.
        # Si estÃ¡ logueado y NO tiene cÃ©dula, lo enviamos a completar perfil.
        # Se usa getattr para seguridad en caso de que el campo no exista o sea None.
        if not getattr(usuario, 'cedula', None):
            messages.warning(request, "Debe completar su perfil para acceder al sistema.")
            return redirect('url_completar_perfil', user_id=usuario.id)
            
    # -------------------------------------------------------------------
    
    contexto = {
        'usuario_autenticado': request.user.is_authenticated,
        'rol_usuario': getattr(request.user, 'rol', None) if request.user.is_authenticated else None,
        'torre_asignada': getattr(request.user, 'torre', None) if request.user.is_authenticated else None,
    }
    return render(request, 'homeDashboard.html', contexto)

@login_required 
def vista_logout(request):
    """
    Cierra la sesiÃ³n del usuario y redirige al dashboard en modo espectador.
    """
    logout(request)
    return redirect('url_dashboard') 

def vista_login(request):
    """Maneja la autenticaciÃ³n del usuario."""
    
    # Si el usuario ya estÃ¡ autenticado, simplemente se redirige.
    if request.user.is_authenticated:
        return redirect('url_dashboard')
    
    if request.method == 'POST':
        formulario = AuthenticationForm(request, data=request.POST)
        if formulario.is_valid():
            username = formulario.cleaned_data.get('username')
            password = formulario.cleaned_data.get('password')
            usuario = authenticate(username=username, password=password)
            if usuario is not None:
                # ðŸ”‘ MODIFICACIÃ“N AQUÃ: Usar 'cedula' para forzar la redirecciÃ³n a completar perfil, 
                # en lugar de 'is_active', si el login fue exitoso.
                if not getattr(usuario, 'cedula', None):
                    messages.warning(request, 'Su perfil estÃ¡ incompleto. Por favor, complete sus datos.')
                    return redirect('url_completar_perfil', user_id=usuario.id)
                
                # Si todo estÃ¡ completo, inicia sesiÃ³n y redirige al dashboard
                autenticar_login(request, usuario)
                return redirect('url_dashboard') 
            else:
                messages.error(request, 'Nombre de usuario o contraseÃ±a incorrectos.')
        else:
            messages.error(request, 'Error en la forma de autenticaciÃ³n.')
    
    formulario = AuthenticationForm()
    
    # Obtener mensajes existentes para mostrarlos
    storage = get_messages(request)
    
    return render(request, 'login.html', {'formulario': formulario, 'messages': storage})

def vista_registro(request):
    """Maneja la creaciÃ³n de nuevos usuarios."""
    if request.user.is_authenticated:
        return redirect('url_dashboard')

    if request.method == 'POST':
        formulario = FormularioCreacionUsuario(request.POST)
        if formulario.is_valid():
            usuario = formulario.save(commit=False)
            
            # El usuario DEBE estar activo (True) para que autenticar_login funcione.
            # Por defecto, Django lo guarda como is_active=True.
            usuario.save() 
            
            # PASO CRÃTICO: Iniciar sesiÃ³n y redirigir al perfil.
            autenticar_login(request, usuario) 
            
            messages.success(request, f'Cuenta creada exitosamente para {usuario.username}. Por favor, complete su perfil.')
            
            # Redirigir directamente al perfil para evitar el bucle inicial del dashboard.
            return redirect('url_completar_perfil', user_id=usuario.id) 
        else:
            # Mostrar errores de validaciÃ³n del formulario de registro
            for field, errors in formulario.errors.items():
                for error in errors:
                    field_name = formulario.fields.get(field).label if field in formulario.fields and formulario.fields.get(field).label else field
                    messages.error(request, f"Error en {field_name}: {error}")

    formulario = FormularioCreacionUsuario()
    return render(request, 'register.html', {'formulario': formulario})

@login_required
def vista_completar_perfil(request, user_id):
    """
    Permite a un nuevo usuario (LÃ­der) completar sus datos de perfil (Torre, CÃ©dula, etc.)
    y activar su cuenta.
    """
    usuario = get_object_or_404(CustomUser, pk=user_id)
    
    # Asegurar que solo el propio usuario pueda completar su perfil
    if request.user.id != usuario.id:
        messages.error(request, 'No tiene permisos para editar el perfil de otro usuario.')
        return redirect('url_dashboard')
    
    # ðŸ”‘ MODIFICACIÃ“N: Si el usuario tiene CÃ©dula (perfil completo), lo redirigimos
    if getattr(usuario, 'cedula', None):
        messages.info(request, "Su perfil ya estÃ¡ completo.")
        return redirect('url_dashboard')
    
    # LÃNEA ELIMINADA: Ya no verificamos if usuario.is_active, sino la cÃ©dula.

    if request.method == 'POST':
        formulario = FormularioPerfilUsuario(request.POST, instance=usuario)
        if formulario.is_valid():
            formulario.save()
            
            # NO ES NECESARIO SETEAR is_active=True NI HACER login de nuevo
            # ya que el usuario siempre estuvo activo y logueado, solo que incompleto.
            
            messages.success(request, 'Perfil completado con Ã©xito. Â¡Bienvenido a la comunidad!')
            return redirect('url_dashboard')
        else:
            messages.error(request, 'El formulario contiene errores. Por favor, corrÃ­gelos a continuaciÃ³n:')
            
            # Iterar sobre todos los errores del formulario (incluidos los globales bajo el key '__all__')
            for field, errors in formulario.errors.items():
                for error in errors:
                    if field == '__all__':
                        messages.error(request, f"{error}")
                    else:
                        field_name = formulario.fields.get(field).label if field in formulario.fields else field
                        messages.error(request, f"Error en {field_name}: {error}")
    
    else:
        formulario = FormularioPerfilUsuario(instance=usuario)
        
    return render(request, 'completar_perfil.html', {
        'formulario': formulario, 
        'usuario': usuario
    })


# ------------------------------------------------------------------
# --- NUEVAS VISTAS: ADMINISTRACIÃ“N DE INGRESOS Y EGRESOS (USUARIO BÃSICO) ---
# ------------------------------------------------------------------

def ver_ingresos_egresos(request, categoria_slug):
    """
    Muestra la lista de movimientos financieros para Condominio o Cuarto de Basura.
    Accesible por usuarios NO autenticados (Usuario BÃ¡sico).
    """
    # 1. Definir la categorÃ­a y el tÃ­tulo basados en el slug de la URL
    if categoria_slug == 'condominio':
        categoria_filtro = 'CON'
        titulo = 'AdministraciÃ³n de Ingresos y Egresos - Condominio'
        monto_field = 'monto_condominio' # Campo de monto dinÃ¡mico
    elif categoria_slug == 'basura':
        categoria_filtro = 'BAS'
        titulo = 'AdministraciÃ³n de Ingresos y Egresos - Cuarto de Basura'
        monto_field = 'monto_basura' # Campo de monto dinÃ¡mico
    else:
        # Si la URL es invÃ¡lida, se redirige al dashboard.
        return redirect('url_dashboard') 
        
    # =========================================================================
    # LÃ“GICA DE MANEJO DE POST (REGISTRO DE MOVIMIENTO)
    # Resuelve: 1. Saldo Negativo, 2. RestricciÃ³n por Torre, 3. Registro/RedirecciÃ³n
    # =========================================================================
    if request.method == 'POST':
        # 1. Validar y Obtener datos del formulario POST
        try:
            fecha = request.POST['fecha']
            descripcion = request.POST['descripcion']
            tipo = request.POST['tipo'] # 'ING' o 'EGR'

            # --- AGREGADO: Extraer Tasa BCV ---
            tasa_bcv = Decimal(request.POST['tasa_bcv']) # Usar Decimal para precisiÃ³n
            if tasa_bcv <= 0:
                raise ValueError("La Tasa BCV debe ser un valor positivo.")
            # ----------------------------------
            
            # Asegurar que el monto es un nÃºmero positivo
            monto = float(request.POST['monto'])
            if monto <= 0: 
                raise ValueError("El monto debe ser una cantidad positiva.")
                
        except (KeyError, ValueError) as e:
            # Mensaje de error mejorado para el formulario
            messages.error(request, f'Error en los datos del movimiento. Verifique la fecha, descripciÃ³n, tipo y monto. Detalle: {e}.')
            return redirect('ver_finanzas', categoria_slug=categoria_slug)
            
        # 2. RestricciÃ³n por Torre (Se mantiene la lÃ³gica)
        if not request.user.is_authenticated or request.user.rol != 'LDT' or not request.user.tower:
            messages.error(request, 'OperaciÃ³n denegada. Solo los LÃ­deres de Torre asignados pueden registrar movimientos.')
            return redirect('ver_finanzas', categoria_slug=categoria_slug)
            
        torre_asignada = request.user.tower
        
        # 3. **Prevenir Saldo Negativo (Problema 1 - REFORZADO)**
        if tipo == 'EGR':
            # Usa el Manager para calcular el saldo de la categorÃ­a correcta
            saldo_actual = MovimientoFinanciero.objects.calcular_saldo_torre(
                tower=torre_asignada, 
                categoria=categoria_filtro
            )
            
            # VALIDACIÃ“N CRÃTICA:
            if saldo_actual - monto < 0:
                messages.error(request, f'OperaciÃ³n denegada. Saldo insuficiente para este egreso. Saldo actual: Bs. {saldo_actual:.2f}')
                return redirect('ver_finanzas', categoria_slug=categoria_slug) # RedirecciÃ³n a la pÃ¡gina actual

        # 4. Crear la instancia del Movimiento (aÃºn sin guardar en DB)
        movimiento = MovimientoFinanciero(
            fecha=fecha,
            descripcion=descripcion,
            tasa_bcv=tasa_bcv,
            tipo=tipo,
            categoria=categoria_filtro, 
            creado_por=request.user,
            tower=torre_asignada,
        )
        
        # 5. **Asignar el Monto Correcto (Problema 2 - Registro de Basura)**
        # Se asigna el monto al campo correspondiente a la categorÃ­a.
        if categoria_filtro == 'CON':
            movimiento.monto_condominio = monto
            movimiento.monto_basura = 0.00 
        else: # categoria_filtro == 'BAS'
            movimiento.monto_basura = monto
            movimiento.monto_condominio = 0.00 

        # 6. Guardar la instancia (Una sola vez)
        try:
            movimiento.save() 
            messages.success(request, f'Movimiento de {movimiento.get_tipo_display()} registrado con Ã©xito en {movimiento.get_categoria_display()}.')
        except Exception as e:
            # Capturar cualquier error inesperado de DB o modelo
            messages.error(request, f'Error inesperado al guardar el movimiento. Por favor, intente de nuevo. Detalle: {e}')
        
        # **RedirecciÃ³n Correcta (Problema 2 - RedirecciÃ³n)**
        # Redirecciona a la pÃ¡gina con el slug correcto ('condominio' o 'basura')
        return redirect('ver_finanzas', categoria_slug=categoria_slug)


    # =========================================================================
    # LÃ“GICA DE MANEJO DE GET (LISTADO Y FILTROS)
    # =========================================================================

    # 2. Obtener opciones de filtro (Todas las Torres)
    torres = Tower.objects.all().order_by('nombre')
    
    # 3. Aplicar filtros iniciales y ordenar
    # --- CORRECCIÃ“N 1: Usar select_related('tower') para optimizar la consulta y cargar el objeto 'tower' ---
    # Nota: El cÃ³digo original usaba 'torre', lo ajusto a 'tower' para seguir la convenciÃ³n del modelo.
    movimientos_query = MovimientoFinanciero.objects.filter(categoria=categoria_filtro).select_related('tower').order_by('fecha', 'id')

    # Filtro por tipo (Ingreso, Egreso, Ambos)
    tipo_filtro = request.GET.get('tipo', 'AMBOS')
    if tipo_filtro == 'INGRESOS':
        movimientos_query = movimientos_query.filter(tipo='ING')
    elif tipo_filtro == 'EGRESOS':
        movimientos_query = movimientos_query.filter(tipo='EGR')

    # Filtro por torre 
    torre_id = request.GET.get('torre')
    if torre_id and torre_id.isdigit(): 
        movimientos_query = movimientos_query.filter(tower__id=int(torre_id))

    # -----------------------------------------------------------
    # âš ï¸ AÃ‘ADIR NUEVO FILTRO POR RANGO DE FECHAS (AquÃ­ estÃ¡n los cambios)
    # -----------------------------------------------------------
    filtro_form = FormularioFiltroMovimientos(request.GET)
    
    if filtro_form.is_valid():
        fecha_inicio = filtro_form.cleaned_data.get('fecha_inicio')
        fecha_fin = filtro_form.cleaned_data.get('fecha_fin')
        
        if fecha_inicio:
            # Filtrar movimientos donde la fecha es MAYOR O IGUAL a la fecha de inicio
            movimientos_query = movimientos_query.filter(fecha__gte=fecha_inicio)
            
        if fecha_fin:
            # Filtrar movimientos donde la fecha es MENOR O IGUAL a la fecha de fin
            movimientos_query = movimientos_query.filter(fecha__lte=fecha_fin)
        
    # 4. CÃ¡lculo del Saldo Acumulado
    movimientos_con_saldo = []
    saldo_acumulado = 0
    
    for mov in movimientos_query:
        # --- CORRECCIÃ“N 2 (Del turno anterior): Obtener el monto correcto del objeto ---
        monto = getattr(mov, monto_field)
        
        # Inicializar ingreso/egreso para el diccionario final
        ingreso_monto = None
        egreso_monto = None

        # Sumar o restar al saldo acumulado
        if mov.tipo == 'ING':
            saldo_acumulado += monto
            ingreso_monto = monto
        elif mov.tipo == 'EGR': # EGR
            saldo_acumulado -= monto
            egreso_monto = monto
            
        # --- CORRECCIÃ“N 3: Manejar el AttributeError para 'tower' ---
        # 1. Comprueba si el atributo 'tower' existe en el objeto (hasattr).
        # 2. Si existe y tiene un valor (es decir, no es None), usa el nombre de la torre.
        # 3. Si no existe o es None, usa 'General'.
        if hasattr(mov, 'tower') and mov.tower:
            nombre_torre = mov.tower.nombre
        else:
            nombre_torre = 'General'
            
        # Preparar los datos para la plantilla
        movimientos_con_saldo.append({
            'fecha': mov.fecha,
            'descripcion': mov.descripcion,
            'tasa_bcv': mov.tasa_bcv,
            # Mostrar solo el monto en la columna correcta 
            'ingreso': ingreso_monto if ingreso_monto and ingreso_monto > 0 else None, 
            'egreso': egreso_monto if egreso_monto and egreso_monto > 0 else None,
            'torre': nombre_torre, # Usar la variable segura
            'saldo': round(saldo_acumulado, 2), # Redondear a dos decimales
            'tipo': mov.tipo,
            'categoria': mov.categoria,
        })
        
    context = {
        'titulo': titulo,
        'movimientos': movimientos_con_saldo,
        'torres': torres,
        'tipo_seleccionado': tipo_filtro,
        'torre_seleccionada_id': torre_id,
        'categoria_slug': categoria_slug, # Para el botÃ³n de descarga
        'filtro_form': filtro_form, # Formulario de filtro para la plantilla
    }

    return render(request, 'finanzas/listado_movimientos.html', context)

def descargar_pdf(request, categoria_slug):
    """
    Genera y descarga el archivo PDF con la informaciÃ³n financiera filtrada.
    """
    # 1. Definir la categorÃ­a, tÃ­tulo y campo de monto (monto_field)
    if categoria_slug == 'condominio':
        categoria_filtro = 'CON'
        titulo = 'Reporte Financiero - Condominio'
        monto_field = 'monto_condominio' 
    elif categoria_slug == 'basura':
        categoria_filtro = 'BAS'
        titulo = 'Reporte Financiero - Cuarto de Basura'
        monto_field = 'monto_basura'
    else:
        # Redireccionar si el slug es invÃ¡lido
        return redirect('url_dashboard')

    # 2. Obtener QuerySet Base
    movimientos_query = MovimientoFinanciero.objects.filter(categoria=categoria_filtro).select_related('tower').order_by('fecha', 'id')

    # 3. FILTROS POR TIPO Y TORRE (LÃ³gica existente)
    tipo_filtro = request.GET.get('tipo', 'AMBOS')
    if tipo_filtro == 'INGRESOS':
        movimientos_query = movimientos_query.filter(tipo='ING')
    elif tipo_filtro == 'EGRESOS':
        movimientos_query = movimientos_query.filter(tipo='EGR')

    torre_id = request.GET.get('torre')
    if torre_id and torre_id.isdigit(): 
        movimientos_query = movimientos_query.filter(tower__id=int(torre_id))
    
    # 4. ðŸš€ APLICAR FILTRO POR RANGO DE FECHAS (NUEVO)
    filtro_form = FormularioFiltroMovimientos(request.GET)
    
    if filtro_form.is_valid():
        fecha_inicio = filtro_form.cleaned_data.get('fecha_inicio')
        fecha_fin = filtro_form.cleaned_data.get('fecha_fin')
        
        if fecha_inicio:
            # Filtrar movimientos donde la fecha es MAYOR O IGUAL a la fecha de inicio
            movimientos_query = movimientos_query.filter(fecha__gte=fecha_inicio)
            
        if fecha_fin:
            # Filtrar movimientos donde la fecha es MENOR O IGUAL a la fecha de fin
            movimientos_query = movimientos_query.filter(fecha__lte=fecha_fin)
            
    # --- FIN LÃ³gica de Filtrado ---

    # 5. ConfiguraciÃ³n de la Respuesta HTTP
    response = HttpResponse(content_type='application/pdf')
    response['Content-Disposition'] = f'attachment; filename=\"Reporte_{categoria_slug}_{timezone.now().strftime("%Y%m%d")}.pdf\"'

    # 6. PreparaciÃ³n del documento PDF con SimpleDocTemplate
    doc = SimpleDocTemplate(response, pagesize=letter, topMargin=inch/2, bottomMargin=inch/2, leftMargin=inch/2, rightMargin=inch/2)
    styles = getSampleStyleSheet()
    Story = []
    
    # --- 7. Encabezado del Reporte ---
    Story.append(Paragraph(f'<font size="16"><b>{titulo}</b></font>', styles['h1']))
    Story.append(Paragraph(f'<font size="10">Generado el: {timezone.now().strftime("%d/%m/%Y a las %H:%M")}</font>', styles['Normal']))
    Story.append(Paragraph('<br/>', styles['Normal']))
    
    # Info de Filtros (para mostrar quÃ© se filtrÃ³)
    filtro_info_text = f"<b>Tipo:</b> {tipo_filtro} | <b>Torre ID:</b> {torre_id if torre_id else 'Todas'}"
    
    # Detalle de Fechas
    f_i = filtro_form.cleaned_data.get('fecha_inicio')
    f_f = filtro_form.cleaned_data.get('fecha_fin')
    
    fecha_text = "Todo el Historial"
    if f_i or f_f:
        inicio_str = f_i.strftime('%d/%m/%Y') if f_i else 'Inicio'
        fin_str = f_f.strftime('%d/%m/%Y') if f_f else 'Fin'
        fecha_text = f"{inicio_str} hasta {fin_str}"
        
    filtro_info_text += f" | <b>Rango de Fechas:</b> {fecha_text}"

    Story.append(Paragraph(f'<font size="10">{filtro_info_text}</font>', styles['Normal']))
    Story.append(Paragraph('<br/>', styles['Normal']))
    
    # --- 8. PreparaciÃ³n de la Tabla de Datos ---
    
    # Cabecera de la tabla
    data = [
        ['Fecha', 'DescripciÃ³n', 'Torre', 'Tasa BCV', 'Ingreso (Bs.)', 'Egreso (Bs.)', 'Saldo Acumulado (Bs.)']
    ]

    # Inicializar Saldo Acumulado (Decimal para precisiÃ³n)
    saldo_acumulado = Decimal(0.00)
    
    for mov in movimientos_query:
        monto = getattr(mov, monto_field) 
        
        ingreso = ''
        egreso = ''
        
        if mov.tipo == 'ING':
            saldo_acumulado += monto
            ingreso = f"{monto:,.2f}" # Formato de moneda
        elif mov.tipo == 'EGR':
            saldo_acumulado -= monto
            egreso = f"({monto:,.2f})" # Usamos parÃ©ntesis para egresos
            
        # 1. Determinar el nombre inicial de la torre
        nombre_torre = mov.tower.nombre if mov.tower else 'General'

        # 2. LÃ“GICA PARA OCULTAR LA TORRE EN EGRESOS DE BASURA
        # Si es un egreso (EGR) Y es de categorÃ­a Basura (BAS), la torre debe ser 'General'.
        if mov.tipo == 'EGR' and mov.categoria == 'BAS':
            nombre_torre = 'General'
            
        tasa_bcv_str = f"{mov.tasa_bcv:,.2f}"

        data.append([
            mov.fecha.strftime('%d/%m/%Y'),
            mov.descripcion,
            nombre_torre, # <-- Esta variable ahora contiene 'General' si aplica
            tasa_bcv_str,
            ingreso,
            egreso,
            f"{saldo_acumulado:,.2f}", 
        ])
        
    # --- 9. CreaciÃ³n y Estilo de la Tabla ---
    
    # Anchos de columna
    table_col_widths = [1.0*inch, 2.5*inch, 0.7*inch, 0.7*inch, 1.0*inch, 1.0*inch, 1.4*inch]
    
    table = Table(data, colWidths=table_col_widths)
    
    table.setStyle(TableStyle([
        ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#2c3e50')), 
        ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
        ('ALIGN', (0, 0), (3, -1), 'LEFT'), 
        ('ALIGN', (4, 1), (-1, -1), 'RIGHT'), # AlineaciÃ³n derecha para montos y saldo
        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
        ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
        ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#f7f7f7')), 
        ('GRID', (0, 0), (-1, -1), 0.5, colors.grey),
        ('FONTSIZE', (0, 0), (-1, -1), 9),
    ]))
    
    Story.append(table)

    # --- 10. Saldo Total Final ---
    Story.append(Paragraph('<br/><br/>', styles['Normal']))
    Story.append(Paragraph(f'<font size="14"><b>SALDO FINAL CALCULADO: Bs. {saldo_acumulado:,.2f}</b></font>', styles['h2']))

    # 11. Construir el PDF
    doc.build(Story)
    return response


================================================
FILE: App_Home/static/css/styles-HD.css
================================================
@import url('material-theme/light.css');

.dashboard-container {
    width: 100%;
    max-width: 1200px;
    padding: 20px;
    background-color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    margin: 20px;
}

/* Encabezado (sin cambios) */
.dashboard-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--md-sys-color-secondary);
}

/* Contenedor de Botones (Grid Responsive y Adaptable) (sin cambios) */
.botones-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    justify-content: center; 
    align-items: stretch;
}

/* Estilos de los Botones Principales (sin cambios en la base) */
.boton-principal {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 25px 15px;
    background-color: var(--md-sys-color-primary);
    color: white;
    text-decoration: none;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.1em;
    font-weight: bold;
    transition: background-color 0.3s, box-shadow 0.2s;
    text-align: center;
    min-height: 120px;
    line-height: 1.4;
    width: 100%;
}

.boton-principal:hover {
    background-color: #0056b3;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
}

.boton-principal i {
    font-size: 2em;
    margin-bottom: 10px;
}

/* Estilos para el Dropdown (AdministraciÃƒÂ³n) */
.dropdown {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    min-height: 120px;
    box-shadow: none;
    transition: none;
    /* QUITAMOS el hover del contenedor padre aquÃƒÂ­, JavaScript lo manejarÃƒÂ¡ */
}

.dropdown .boton-principal.dropbtn {
    flex-grow: 1;
    border-radius: 8px;
}

/* Estilos del contenido desplegable */
.dropdown-content {
    /* Ocultamos el contenido por defecto con height: 0 y overflow: hidden */
    display: block; /* Para que tome el espacio, pero lo controlamos con height */
    overflow: hidden;
    height: 0;
    opacity: 0;
    transition: height 0.3s ease-out, opacity 0.3s ease-out; /* TransiciÃƒÂ³n para animaciÃƒÂ³n */

    position: absolute; /* Para que no afecte el layout cuando estÃƒÂ¡ oculto */
    background-color: #f9f9f9;
    width: 100%; 
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 10;
    border-radius: 0 0 8px 8px;
    top: 100%;
    left: 0;
}

/* Clase para mostrar el menÃƒÂº, aÃƒÂ±adida/removida por JavaScript */
.dropdown-content.show {
    height: auto; /* Permite que el contenido tome su altura natural */
    opacity: 1;
    /* Ajusta max-height si tienes un contenido muy variable, o dÃƒÂ©jalo en auto */
    /* Por ejemplo: max-height: 200px; */ 
    height: auto; /* Se ajusta a la altura del contenido */
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    text-align: center;
    font-size: 1em;
    border-bottom: 1px solid #eee;
}

.dropdown-content a:last-child {
    border-bottom: none;
}

.dropdown-content a:hover {
    background-color: #ddd;
    color: var(--md-sys-color-primary);
}

/* Media Queries para Responsive (sin cambios) */
@media (min-width: 600px) {
    .botones-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (min-width: 900px) {
    .botones-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}


================================================
FILE: App_Home/static/css/styles-lidergeneral.css
================================================
/* App_Home/static/css/styles-lidergeneral.css */

/* 1. Importar la paleta de colores Material Design Light */
@import url('material-theme/light.css');

/* 2. Contenedor General (Mismo estilo que el dashboard) */
.user-container {
    width: 100%;
    max-width: 1200px;
    padding: 20px;
    background-color: var(--md-sys-color-surface); /* Blanco claro */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    margin: 20px auto; /* Centrar el contenedor */
}

/* 3. Estilos de Tabla: Lista de Usuarios (lista_usuarios.html) */

.table-responsive {
    overflow-x: auto; /* Hace la tabla responsive en pantallas pequeÃƒÂ±as */
}

.table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    font-size: 0.9em;
}

.table thead th {
    background-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary); /* Texto blanco */
    padding: 12px 15px;
    text-align: left;
    white-space: nowrap; /* Evita que los encabezados se envuelvan */
}

.table tbody tr:nth-child(even) {
    background-color: var(--md-sys-color-surface-variant); /* Raya par */
}

.table tbody tr:hover {
    background-color: var(--md-sys-color-secondary-container); /* Resaltar al pasar el mouse */
}

.table tbody td {
    padding: 10px 15px;
    border-bottom: 1px solid var(--md-sys-color-outline-variant);
}

/* Estilos para badges (Activo/Inactivo) */
.badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.75em;
    font-weight: 600;
}
.bg-success {
    background-color: var(--md-sys-color-tertiary);
    color: var(--md-sys-color-on-tertiary);
}
.bg-danger {
    background-color: var(--md-sys-color-error);
    color: var(--md-sys-color-on-error);
}

/* 4. Estilos de Formulario (usuario_form.html) */

.form-group {
    margin-bottom: 15px;
}

.form-label {
    font-weight: 600;
    color: var(--md-sys-color-on-surface);
    display: block;
    margin-bottom: 5px;
}

/* Estilo para inputs (Select, Text, etc.) */
.form-group input:not([type="checkbox"]), 
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--md-sys-color-outline);
    border-radius: 4px;
    transition: border-color 0.3s;
    background-color: var(--md-sys-color-surface);
}

.form-group input:focus, 
.form-group select:focus,
.form-group textarea:focus {
    border-color: var(--md-sys-color-primary); /* Resaltar al enfocar */
    outline: none;
}

/* Estilo de la grid responsiva (col-md-6) */
.row.g-3 {
    display: flex;
    flex-wrap: wrap;
    margin: -8px; /* Ajuste para el padding interno de col-md-6 */
}
.row.g-3 > .col-md-6 {
    padding: 8px; /* Espaciado entre columnas */
    flex: 0 0 100%; /* Por defecto 100% en mÃƒÂ³vil */
    max-width: 100%;
}
@media (min-width: 768px) { /* Tablet y Desktop */
    .row.g-3 > .col-md-6 {
        flex: 0 0 50%; /* Dos columnas en desktop */
        max-width: 50%;
    }
}

/* 5. Estilos de Botones (Botones de acciÃƒÂ³n en formularios/listas) */

.btn {
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 5px;
    justify-content: center;
}

.btn-primary {
    background-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary);
}
.btn-primary:hover {
    background-color: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-on-primary-container);
}

.btn-success {
    background-color: #388e3c; /* Tonalidad de ÃƒÂ©xito */
    color: white;
}
.btn-success:hover {
    background-color: #4caf50;
}

.btn-info {
    background-color: var(--md-sys-color-secondary);
    color: var(--md-sys-color-on-secondary);
}
.btn-info:hover {
    background-color: var(--md-sys-color-secondary-container);
    color: var(--md-sys-color-on-secondary-container);
}

.btn-danger {
    background-color: var(--md-sys-color-error);
    color: var(--md-sys-color-on-error);
}
.btn-danger:hover {
    background-color: #cf6679; /* Tono de error mÃƒÂ¡s claro */
}

.btn-secondary {
    background-color: var(--md-sys-color-outline);
    color: var(--md-sys-color-on-surface);
}
.btn-secondary:hover {
    background-color: var(--md-sys-color-surface-variant);
}


/* 6. Estilos de Alertas (usuario_confirm_delete.html y usuario_form.html) */

.alert {
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid transparent;
    border-radius: 4px;
}

.alert-danger {
    background-color: rgba(244, 67, 54, 0.1); /* Error claro */
    color: var(--md-sys-color-error);
    border-color: var(--md-sys-color-error);
}

.alert-warning {
    background-color: rgba(255, 152, 0, 0.1); /* Advertencia claro */
    color: #ff9800;
    border-color: #ff9800;
}

.alert-heading {
    font-weight: 700;
    margin-bottom: 5px;
}


================================================
FILE: App_Home/static/css/styles-listado.css
================================================
/* CAMBIO CLAVE 1: Importar la paleta de colores Material Design */
@import url('material-theme/light.css');

/* Contenedor principal */
.container.mt-5 {
    padding: 20px;
    background-color: var(--md-sys-color-surface); /* Fondo blanco/claro */
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

/* TÃƒÂ­tulo */
h2.mb-4 {
    /* CAMBIO 2: Usar el color Primario del tema */
    color: var(--md-sys-color-primary);
    border-bottom: 2px solid var(--md-sys-color-outline-variant);
    padding-bottom: 10px;
    margin-bottom: 20px !important;
}

/* Formulario de Filtros */
.row.g-3.mb-4 {
    padding: 15px;
    background-color: var(--md-sys-color-surface-container-low); /* Contenedor de filtros */
    border-radius: 6px;
    margin-bottom: 30px !important;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
}

.form-label {
    font-weight: 600;
    color: var(--md-sys-color-on-surface-variant);
}

/* Botones de acciÃƒÂ³n */
/* CAMBIO 3: Usar variables para los botones (Primario para aplicar, Error para PDF) */
.btn-primary {
    background-color: var(--md-sys-color-primary);
    border-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary);
}

.btn-primary:hover {
    background-color: var(--md-sys-color-primary-dark); /* Asumiendo un hover mÃƒÂ¡s oscuro */
    border-color: var(--md-sys-color-primary-dark);
}

.btn-danger {
    background-color: var(--md-sys-color-error);
    border-color: var(--md-sys-color-error);
    color: var(--md-sys-color-on-error);
}

.btn-danger:hover {
    background-color: var(--md-sys-color-error-dark); /* Asumiendo un hover mÃƒÂ¡s oscuro */
    border-color: var(--md-sys-color-error-dark);
}

/* Tabla de Movimientos */
.table-responsive {
    /* Forzar un alto mÃƒÂ¡ximo para que el scroll se active (70% del alto de la ventana) */
    max-height: 70vh; 
    /* Habilitar el scroll vertical si el contenido excede el max-height */
    overflow-y: auto; 
    
    /* Reglas originales (mantener) */
    overflow-x: auto;
    margin-top: 20px;
    
    /* Estilos estÃƒÂ©ticos opcionales para delimitar la caja de scroll */
    border: 1px solid var(--md-sys-color-outline-variant); 
    border-radius: 6px;
}

.table {
    min-width: 700px;
    margin-bottom: 0; /* Evita doble margen con el scroll */
    width: 100%;
}

.table-dark th {
    /* Usar un color secundario para el encabezado de la tabla, o un fondo oscuro */
    background-color: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-on-primary-container);
    font-weight: 600;
}

/* Estilos para Ingresos y Egresos */
/* CAMBIO 4: Usar colores de ÃƒÂ©xito y peligro para los montos */
.text-success {
    color: var(--md-sys-color-success) !important; /* Ingresos en verde (Definido en tu theme si existe) */
    font-weight: 500;
}

.text-danger {
    color: var(--md-sys-color-error) !important; /* Egresos en rojo */
    font-weight: 500;
}

/* Columna Saldo */
.table tbody tr td:last-child {
    font-weight: 700;
    color: var(--md-sys-color-on-surface);
}

/* Responsive Design para la tabla */
@media (max-width: 768px) {
    .row.g-3.mb-4 .col-md-4 {
        margin-bottom: 15px;
    }
    .row.g-3.mb-4 .col-md-4:last-child {
        display: block !important;
        text-align: center;
    }
    .row.g-3.mb-4 .col-md-4 .btn {
        width: 100%;
        margin-bottom: 10px;
    }
    
    .table-responsive {
        border: 1px solid var(--md-sys-color-outline-variant);
        border-radius: 6px;
    }
}


/* --- Bloque de Botones de AcciÃƒÂ³n (Reemplaza la versiÃƒÂ³n de menÃƒÂº lateral) --- */

.action-buttons-container {
    margin-top: 30px;
    padding: 20px;
    background-color: var(--md-sys-color-surface-container); /* Fondo sutil para el bloque */
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.action-buttons-title {
    color: var(--md-sys-color-primary);
    border-bottom: 2px solid var(--md-sys-color-outline-variant);
    padding-bottom: 8px;
    margin-bottom: 20px;
    font-size: 1.2em;
    font-weight: 600;
}

/* Grid Responsive para los Botones */
.action-buttons-grid {
    display: grid;
    /* En mÃƒÂ³vil, una columna. En desktop, dos columnas (minmax(250px, 1fr)) */
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
}

.action-button {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 15px 10px;
    text-decoration: none;
    border-radius: 6px;
    font-weight: 600;
    font-size: 1em;
    transition: transform 0.2s, box-shadow 0.2s;
    text-align: center;
}

.action-button i {
    margin-right: 10px;
    font-size: 1.2em;
}

/* Estilos especÃƒÂ­ficos para Condominio/Basura */
.btn-ingreso {
    background-color: var(--md-sys-color-tertiary);
    color: var(--md-sys-color-on-tertiary);
}

.btn-ingreso:hover {
    background-color: var(--md-sys-color-tertiary-container);
    color: var(--md-sys-color-on-tertiary-container);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.btn-egreso {
    background-color: var(--md-sys-color-error);
    color: var(--md-sys-color-on-error);
}

.btn-egreso:hover {
    background-color: var(--md-sys-color-error-container);
    color: var(--md-sys-color-on-error-container);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.btn-disabled {
    background-color: var(--md-sys-color-surface-variant) !important;
    color: var(--md-sys-color-on-surface-variant) !important;
    cursor: not-allowed;
    opacity: 0.7;
    text-decoration: line-through;
}


================================================
FILE: App_Home/static/css/styles-login.css
================================================
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700; 800; 900&display=swap');
@import url('material-theme/light.css');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
}

body {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    /* Se cambia el gradiente a un color de fondo basado en el tema */
    background: var(--md-sys-color-background);
    padding: 20px;
}

/* --- NUEVAS REGLAS CSS PARA MENSAJES DE ALERTA ABSOLUTOS --- */

.message-container {
    /* 1. POSICIONAMIENTO ABSOLUTO Y CENTRADO */
    position: absolute;
    top: 20px; /* Distancia desde el borde superior */
    left: 50%;
    transform: translateX(-50%); /* Centra el elemento horizontalmente */
    width: 90%; /* Ancho mÃƒÂ¡ximo para el contenedor */
    max-width: 450px; /* Limita el ancho en pantallas grandes */
    z-index: 1000; /* Asegura que estÃƒÂ© por encima de todos los demÃƒÂ¡s elementos */
}

.alert {
    /* 2. ESTILO VISUAL Y TRANSICIÃƒâ€œN */
    padding: 15px 20px;
    margin-bottom: 10px;
    border: 1px solid transparent;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    opacity: 1;
    /* Configura la transiciÃƒÂ³n para la opacidad y el desplazamiento */
    transition: opacity 0.5s ease-in-out, transform 0.3s ease-in-out; 
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Estilos de color para errores (error/danger) usando Material Design */
.alert.error, .alert.danger {
    color: var(--md-sys-color-on-error-container);
    background-color: var(--md-sys-color-error-container);
    border-color: var(--md-sys-color-error);
}

/* Estilos de color para ÃƒÂ©xito (success) usando Material Design */
.alert.success {
    color: var(--md-sys-color-on-primary-container);
    background-color: var(--md-sys-color-primary-container);
    border-color: var(--md-sys-color-primary);
}

/* Estilos de color para otros mensajes (info/warning) usando Material Design */
.alert.info, .alert.warning {
    color: var(--md-sys-color-on-tertiary-container);
    background-color: var(--md-sys-color-tertiary-container);
    border-color: var(--md-sys-color-tertiary);
}

/* 3. CLASE PARA DESAPARECER (OPACIDAD Y DESPLAZAMIENTO) */
.alert.hide {
    opacity: 0;
    transform: translateY(-20px);
}

/* --- FIN DE LAS NUEVAS REGLAS CSS PARA MENSAJES DE ALERTA --- */

.container {
    position: relative;
    width: 850px;
    height: 550px;
    /* Se cambia #fff por el color de superficie */
    background: var(--md-sys-color-surface);
    border-radius: 30px;
    box-shadow: 0 0px 30px rgba(0, 0, 0, 0.2);
    margin: 20px;
    overflow: hidden;
}

.form-box {
    position: absolute;
    right: 0;
    width: 50%;
    height: 100%;
    /* Se cambia #fff por el color de superficie */
    background: var(--md-sys-color-surface);
    display: flex;
    align-items: center;
    /* Se cambia #333 por el color de texto principal */
    color: var(--md-sys-color-on-surface);
    text-align: center;
    padding: 40px;
    z-index: 1;
    transition: .6s ease-in-out 1.2s, visibility 0s 1s;
}

.container.active .form-box {
    right: 50%;
}

.form-box.register {
    visibility: hidden;
}

.container.active .form-box.register {
    visibility: visible;
    z-index: 2;
}

form {
    width: 100%;
}

.container h1 {
    font-size: 36px;
    margin: -10px 0;
}

.input-box {
    position: relative;
    margin: 30px 0;
}

.input-box input {
    width: 100%;
    padding: 13px 50px 13px 20px;
    /* Se cambia #eee por un color de fondo de contenedor de superficie claro */
    background: var(--md-sys-color-surface-container-low);
    border-radius: 8px;
    border: none;
    outline: none;
    font-size: 16px;
    /* Se cambia #333 por el color de texto principal */
    color: var(--md-sys-color-on-surface);
    font-weight: 500;
}

.input-box input::placeholder {
    /* Se cambia #888 por un color de texto secundario */
    color: var(--md-sys-color-on-surface-variant);
    font-weight: 400;
}

.input-box i {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    /* Se cambia #888 por un color de texto secundario */
    color: var(--md-sys-color-on-surface-variant);
}

.forgot-link {
    margin: -15px 0 15px;
}

.forgot-link a {
    font-size: 14.5px;
    /* Se cambia #333 por el color de texto principal */
    color: var(--md-sys-color-on-surface);
    text-decoration: none;
}

.btn {
    width: 100%;
    height: 48px;
    /* Se cambia #7494ec por el color primario */
    background: var(--md-sys-color-primary);
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, .1);
    border: none;
    cursor: pointer;
    font-size: 16px;
    /* Se cambia #fff por el color de texto sobre primario */
    color: var(--md-sys-color-on-primary);
    font-weight: 600;
}

.container p {
    font-size: 14.5px;
    margin: 15px 0;
}

.toggle-box {
    position: absolute;
    width: 100%;
    height: 100%;
}

.toggle-box::before {
    content: '';
    position: absolute;
    left: -250%;
    width: 300%;
    height: 100%;
    /* Se cambia #7494ec por el color primario */
    background: var(--md-sys-color-primary);
    border-radius: 150px;
    z-index: 2;
    transition: 1.8s ease-in-out;
}

.container.active .toggle-box::before {
    left: 50%;
}

.toggle-panel {
    position: absolute;
    width: 50%;
    height: 100%;
    /* Se cambia #fff por el color de texto sobre primario */
    color: var(--md-sys-color-on-primary);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 2;
    transition: .6s ease-in-out;
}

.toggle-panel.toggle-left {
    left: 0;
    transition-delay: 1.2s;
}

.container.active .toggle-panel.toggle-left {
    left: -50%;
    transition-delay: .6s;
}

.toggle-panel.toggle-right {
    right: -50%;
    transition-delay: .6s;
}

.container.active .toggle-panel.toggle-right {
    right: 0;
    transition-delay: 1.2s;
}

.toggle-panel p {
    margin-bottom: 20px;
}

.toggle-panel .btn {
    width: 160px;
    height: 46px;
    background: transparent;
    /* Se cambia #fff por el color de texto sobre primario */
    border: 2px solid var(--md-sys-color-on-primary);
    box-shadow: none;
}

.form-box.login .back-link-container {
    /* Mueve el contenedor hacia abajo para separarlo del botÃƒÂ³n */
    margin-top: 20px; 
    text-align: center; /* Centra el enlace */
}

.form-box.login .back-link-container a {
    /* Quita el color morado (que es el default del navegador) */
    color: var(--md-sys-color-secondary); 
    /* Quita el subrayado */
    text-decoration: none; 
    font-weight: 500;
    font-size: 0.9em;
    transition: color 0.3s;
}

.form-box.login .back-link-container a:hover {
    /* Usa el color primario al pasar el ratÃƒÂ³n para resaltar */
    color: var(--md-sys-color-primary); 
    text-decoration: underline; /* Agrega subrayado al pasar el ratÃƒÂ³n */
}

@media screen and (max-width:650px) {
    .container {
        height: calc(100vh - 40px);
    }

    .form-box {
        bottom: 0;
        width: 100%;
        height: 70%;
    }

    .container.active .form-box {
        right: 0;
        bottom: 30%;
    }

    .toggle-box::before {
        left: 0;
        top: -270%;
        width: 100%;
        height: 300%;
        border-radius: 20vw;
    }

    .container.active .toggle-box::before {
        left: 0;
        top: 70%;
    }

    .toggle-panel {
        width: 100%;
        height: 30%;
    }

    .toggle-panel.toggle-left {
        top: 0;
    }

    .container.active .toggle-panel.toggle-left {
        left: 0;
        top: -30%;
    }

    .toggle-panel.toggle-right {
        right: 0;
        bottom: -30%;
    }

    .container.active .toggle-panel.toggle-right {
        bottom: 0;
    }
}

@media screen and (max-width:450px) {
    .form-box {
        padding: 20px;
    }

    .toggle-panel h1 {
        font-size: 30px;
    }
}


================================================
FILE: App_Home/static/css/styles-navbar.css
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8d in position 1377: character maps to <undefined>


================================================
FILE: App_Home/static/css/styles-perfil.css
================================================
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');
@import url('material-theme/light.css'); 

/* ------------------------------------------- */
/* 1. Contenedor de la PÃƒÂ¡gina y el Formulario (Layout General) */
/* ------------------------------------------- */

/* Wrapper: Define el fondo de la pÃƒÂ¡gina y centra el formulario */
.perfil-container-wrapper {
    display: flex;
    justify-content: center;
    /* Alinea arriba en pantallas largas, para que el scroll inicie desde arriba */
    align-items: flex-start; 
    padding: 20px;
    min-height: 100vh;
    /* Usa el color de fondo de Material Design */
    background: var(--md-sys-color-background); 
}

/* Contenedor: La "tarjeta" del formulario (el estilo de card) */
.perfil-container {
    width: 100%;
    max-width: 650px; /* Ancho cÃƒÂ³modo para formularios verticales */
    /* Usa el color de superficie de Material Design */
    background: var(--md-sys-color-surface); 
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    padding: 30px;
    margin: 20px 0; /* Asegura un margen vertical si hay mucho contenido */
    color: var(--md-sys-color-on-surface);
}

.perfil-container h1 {
    text-align: center;
    margin-bottom: 5px;
    font-size: 32px;
    color: var(--md-sys-color-primary);
}

.perfil-container > p {
    text-align: center;
    margin-bottom: 25px;
    color: var(--md-sys-color-on-surface-variant);
    font-weight: 500;
}

/* ------------------------------------------- */
/* 2. Estilos de Formulario (TÃƒÂ­tulos, Grupos, Inputs) */
/* ------------------------------------------- */

.perfil-container h2 {
    margin-top: 30px;
    margin-bottom: 15px;
    padding-bottom: 5px;
    border-bottom: 2px solid var(--md-sys-color-secondary);
    font-size: 24px;
    font-weight: 600;
    color: var(--md-sys-color-on-surface);
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    font-size: 1em;
    color: var(--md-sys-color-on-surface);
}

/* Estilos para inputs (text, email, password) y selects (select) */
.perfil-container input:not([type="checkbox"]),
.perfil-container select {
    width: 100%;
    padding: 12px 15px;
    /* Usa un color de superficie mÃƒÂ¡s bajo para simular el campo de texto */
    background: var(--md-sys-color-surface-container-low); 
    border-radius: 8px;
    /* Usa un color de contorno variante */
    border: 1px solid var(--md-sys-color-outline-variant); 
    outline: none;
    font-size: 16px;
    color: var(--md-sys-color-on-surface);
    transition: border-color 0.3s, box-shadow 0.3s;
    min-height: 48px; /* Altura estÃƒÂ¡ndar para accesibilidad tÃƒÂ¡ctil */
}

.perfil-container input:focus,
.perfil-container select:focus {
    border-color: var(--md-sys-color-primary);
    /* Sombra para efecto de enfoque de Material Design */
    box-shadow: 0 0 0 2px var(--md-sys-color-primary-container);
}

/* ------------------------------------------- */
/* 3. Layout Responsivo para Filas (.form-row) */
/* ------------------------------------------- */

.form-row {
    display: grid;
    /* Por defecto, una columna para dispositivos mÃƒÂ³viles (responsive) */
    grid-template-columns: 1fr; 
    gap: 20px;
}

/* Media Query para Escritorio y Tablets (2 columnas) */
@media (min-width: 600px) {
    .form-row {
        /* En pantallas mÃƒÂ¡s grandes, establece 2 columnas de igual ancho */
        grid-template-columns: 1fr 1fr; 
    }
}

/* ------------------------------------------- */
/* 4. Estilos de Checkboxes y Botones */
/* ------------------------------------------- */

.checkbox-group {
    padding: 15px;
    border: 1px dashed var(--md-sys-color-outline);
    border-radius: 8px;
    background: var(--md-sys-color-surface-container-low);
}

.form-check {
    display: flex;
    align-items: flex-start; 
    margin-bottom: 10px;
    font-size: 1em;
}

.form-check label {
    margin-bottom: 0; /* Elimina el margen inferior predeterminado del label */
    margin-left: 5px;
    font-weight: 400;
}

.form-check input[type="checkbox"] {
    /* Ajusta el checkbox para que se alinee con el texto */
    width: auto;
    height: 1.2em;
    min-height: unset;
    margin-right: 10px;
    margin-top: 3px; 
}

/* Estilo del BotÃƒÂ³n (Similar a styles-login.css) */
.btn {
    width: 100%;
    height: 48px;
    background: var(--md-sys-color-primary);
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 16px;
    color: var(--md-sys-color-on-primary);
    font-weight: 600;
    transition: background-color 0.3s;
    margin-top: 20px !important; /* Fuerza el margen superior */
}

.btn:hover {
    background: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-on-primary-container);
}

/* ------------------------------------------- */
/* 5. Estilos de Mensajes/Alertas de Django */
/* ------------------------------------------- */

.mensajes-django-container {
    margin-bottom: 20px;
}

.alerta {
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 8px;
    font-size: 1em;
    font-weight: 500;
}

/* Colores de Alertas (Adaptados a Material Design) */
.alerta-success { /* tags='success' */
    background-color: var(--md-sys-color-success-container); 
    color: var(--md-sys-color-on-success-container);
    border: 1px solid var(--md-sys-color-success);
}

.alerta-error { /* tags='error' */
    background-color: var(--md-sys-color-error-container);
    color: var(--md-sys-color-on-error-container);
    border: 1px solid var(--md-sys-color-error);
}

.alerta-warning { /* tags='warning' */
    background-color: var(--md-sys-color-warning-container); 
    color: var(--md-sys-color-on-warning-container);
    border: 1px solid var(--md-sys-color-warning);
}

.alerta-info { /* tags='info' o default */
    background-color: var(--md-sys-color-info-container); 
    color: var(--md-sys-color-on-info-container);
    border: 1px solid var(--md-sys-color-info);
}


================================================
FILE: App_Home/static/css/material-theme/dark-hc.css
================================================
.dark-high-contrast {
  --md-sys-color-primary: rgb(193 250 255);
  --md-sys-color-surface-tint: rgb(128 212 219);
  --md-sys-color-on-primary: rgb(0 0 0);
  --md-sys-color-primary-container: rgb(124 208 215);
  --md-sys-color-on-primary-container: rgb(0 14 15);
  --md-sys-color-secondary: rgb(239 238 255);
  --md-sys-color-on-secondary: rgb(0 0 0);
  --md-sys-color-secondary-container: rgb(182 191 253);
  --md-sys-color-on-secondary-container: rgb(0 5 50);
  --md-sys-color-tertiary: rgb(205 247 255);
  --md-sys-color-on-tertiary: rgb(0 0 0);
  --md-sys-color-tertiary-container: rgb(126 207 220);
  --md-sys-color-on-tertiary-container: rgb(0 14 16);
  --md-sys-color-error: rgb(255 236 233);
  --md-sys-color-on-error: rgb(0 0 0);
  --md-sys-color-error-container: rgb(255 174 161);
  --md-sys-color-on-error-container: rgb(34 0 0);
  --md-sys-color-background: rgb(14 20 21);
  --md-sys-color-on-background: rgb(221 228 228);
  --md-sys-color-surface: rgb(14 20 21);
  --md-sys-color-on-surface: rgb(255 255 255);
  --md-sys-color-surface-variant: rgb(63 72 74);
  --md-sys-color-on-surface-variant: rgb(255 255 255);
  --md-sys-color-outline: rgb(232 242 243);
  --md-sys-color-outline-variant: rgb(187 196 198);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(222 227 229);
  --md-sys-color-inverse-on-surface: rgb(0 0 0);
  --md-sys-color-inverse-primary: rgb(0 80 85);
  --md-sys-color-primary-fixed: rgb(157 240 247);
  --md-sys-color-on-primary-fixed: rgb(0 0 0);
  --md-sys-color-primary-fixed-dim: rgb(128 212 219);
  --md-sys-color-on-primary-fixed-variant: rgb(0 20 22);
  --md-sys-color-secondary-fixed: rgb(222 224 255);
  --md-sys-color-on-secondary-fixed: rgb(0 0 0);
  --md-sys-color-secondary-fixed-dim: rgb(186 195 255);
  --md-sys-color-on-secondary-fixed-variant: rgb(0 9 65);
  --md-sys-color-tertiary-fixed: rgb(158 239 253);
  --md-sys-color-on-tertiary-fixed: rgb(0 0 0);
  --md-sys-color-tertiary-fixed-dim: rgb(130 211 224);
  --md-sys-color-on-tertiary-fixed-variant: rgb(0 20 23);
  --md-sys-color-surface-dim: rgb(14 20 21);
  --md-sys-color-surface-bright: rgb(75 81 82);
  --md-sys-color-surface-container-lowest: rgb(0 0 0);
  --md-sys-color-surface-container-low: rgb(27 33 34);
  --md-sys-color-surface-container: rgb(43 49 51);
  --md-sys-color-surface-container-high: rgb(54 60 62);
  --md-sys-color-surface-container-highest: rgb(66 72 73);
}



================================================
FILE: App_Home/static/css/material-theme/dark-mc.css
================================================
.dark-medium-contrast {
  --md-sys-color-primary: rgb(150 234 241);
  --md-sys-color-surface-tint: rgb(128 212 219);
  --md-sys-color-on-primary: rgb(0 43 46);
  --md-sys-color-primary-container: rgb(71 157 164);
  --md-sys-color-on-primary-container: rgb(0 0 0);
  --md-sys-color-secondary: rgb(214 218 255);
  --md-sys-color-on-secondary: rgb(23 33 85);
  --md-sys-color-secondary-container: rgb(132 141 200);
  --md-sys-color-on-secondary-container: rgb(0 0 0);
  --md-sys-color-tertiary: rgb(152 233 247);
  --md-sys-color-on-tertiary: rgb(0 42 48);
  --md-sys-color-tertiary-container: rgb(73 156 169);
  --md-sys-color-on-tertiary-container: rgb(0 0 0);
  --md-sys-color-error: rgb(255 210 203);
  --md-sys-color-on-error: rgb(72 20 13);
  --md-sys-color-error-container: rgb(204 123 111);
  --md-sys-color-on-error-container: rgb(0 0 0);
  --md-sys-color-background: rgb(14 20 21);
  --md-sys-color-on-background: rgb(221 228 228);
  --md-sys-color-surface: rgb(14 20 21);
  --md-sys-color-on-surface: rgb(255 255 255);
  --md-sys-color-surface-variant: rgb(63 72 74);
  --md-sys-color-on-surface-variant: rgb(212 222 224);
  --md-sys-color-outline: rgb(170 180 181);
  --md-sys-color-outline-variant: rgb(136 146 148);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(222 227 229);
  --md-sys-color-inverse-on-surface: rgb(37 43 44);
  --md-sys-color-inverse-primary: rgb(0 80 85);
  --md-sys-color-primary-fixed: rgb(157 240 247);
  --md-sys-color-on-primary-fixed: rgb(0 20 22);
  --md-sys-color-primary-fixed-dim: rgb(128 212 219);
  --md-sys-color-on-primary-fixed-variant: rgb(0 61 65);
  --md-sys-color-secondary-fixed: rgb(222 224 255);
  --md-sys-color-on-secondary-fixed: rgb(0 9 65);
  --md-sys-color-secondary-fixed-dim: rgb(186 195 255);
  --md-sys-color-on-secondary-fixed-variant: rgb(40 50 103);
  --md-sys-color-tertiary-fixed: rgb(158 239 253);
  --md-sys-color-on-tertiary-fixed: rgb(0 20 23);
  --md-sys-color-tertiary-fixed-dim: rgb(130 211 224);
  --md-sys-color-on-tertiary-fixed-variant: rgb(0 60 68);
  --md-sys-color-surface-dim: rgb(14 20 21);
  --md-sys-color-surface-bright: rgb(63 70 71);
  --md-sys-color-surface-container-lowest: rgb(4 8 9);
  --md-sys-color-surface-container-low: rgb(25 31 32);
  --md-sys-color-surface-container: rgb(35 41 42);
  --md-sys-color-surface-container-high: rgb(45 52 53);
  --md-sys-color-surface-container-highest: rgb(57 63 64);
}



================================================
FILE: App_Home/static/css/material-theme/dark.css
================================================
.dark {
  --md-sys-color-primary: rgb(128 212 219);
  --md-sys-color-surface-tint: rgb(128 212 219);
  --md-sys-color-on-primary: rgb(0 54 58);
  --md-sys-color-primary-container: rgb(0 79 84);
  --md-sys-color-on-primary-container: rgb(157 240 247);
  --md-sys-color-secondary: rgb(186 195 255);
  --md-sys-color-on-secondary: rgb(34 44 97);
  --md-sys-color-secondary-container: rgb(57 67 121);
  --md-sys-color-on-secondary-container: rgb(222 224 255);
  --md-sys-color-tertiary: rgb(130 211 224);
  --md-sys-color-on-tertiary: rgb(0 54 61);
  --md-sys-color-tertiary-container: rgb(0 79 88);
  --md-sys-color-on-tertiary-container: rgb(158 239 253);
  --md-sys-color-error: rgb(255 180 168);
  --md-sys-color-on-error: rgb(86 30 22);
  --md-sys-color-error-container: rgb(115 52 42);
  --md-sys-color-on-error-container: rgb(255 218 212);
  --md-sys-color-background: rgb(14 20 21);
  --md-sys-color-on-background: rgb(221 228 228);
  --md-sys-color-surface: rgb(14 20 21);
  --md-sys-color-on-surface: rgb(222 227 229);
  --md-sys-color-surface-variant: rgb(63 72 74);
  --md-sys-color-on-surface-variant: rgb(191 200 202);
  --md-sys-color-outline: rgb(137 146 148);
  --md-sys-color-outline-variant: rgb(63 72 74);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(222 227 229);
  --md-sys-color-inverse-on-surface: rgb(43 49 51);
  --md-sys-color-inverse-primary: rgb(0 105 111);
  --md-sys-color-primary-fixed: rgb(157 240 247);
  --md-sys-color-on-primary-fixed: rgb(0 32 34);
  --md-sys-color-primary-fixed-dim: rgb(128 212 219);
  --md-sys-color-on-primary-fixed-variant: rgb(0 79 84);
  --md-sys-color-secondary-fixed: rgb(222 224 255);
  --md-sys-color-on-secondary-fixed: rgb(11 21 75);
  --md-sys-color-secondary-fixed-dim: rgb(186 195 255);
  --md-sys-color-on-secondary-fixed-variant: rgb(57 67 121);
  --md-sys-color-tertiary-fixed: rgb(158 239 253);
  --md-sys-color-on-tertiary-fixed: rgb(0 31 36);
  --md-sys-color-tertiary-fixed-dim: rgb(130 211 224);
  --md-sys-color-on-tertiary-fixed-variant: rgb(0 79 88);
  --md-sys-color-surface-dim: rgb(14 20 21);
  --md-sys-color-surface-bright: rgb(52 58 59);
  --md-sys-color-surface-container-lowest: rgb(9 15 16);
  --md-sys-color-surface-container-low: rgb(23 29 30);
  --md-sys-color-surface-container: rgb(27 33 34);
  --md-sys-color-surface-container-high: rgb(37 43 44);
  --md-sys-color-surface-container-highest: rgb(48 54 55);
}



================================================
FILE: App_Home/static/css/material-theme/light-hc.css
================================================
.light-high-contrast {
  --md-sys-color-primary: rgb(0 50 53);
  --md-sys-color-surface-tint: rgb(0 105 111);
  --md-sys-color-on-primary: rgb(255 255 255);
  --md-sys-color-primary-container: rgb(0 82 87);
  --md-sys-color-on-primary-container: rgb(255 255 255);
  --md-sys-color-secondary: rgb(30 39 92);
  --md-sys-color-on-secondary: rgb(255 255 255);
  --md-sys-color-secondary-container: rgb(60 69 123);
  --md-sys-color-on-secondary-container: rgb(255 255 255);
  --md-sys-color-tertiary: rgb(0 50 56);
  --md-sys-color-on-tertiary: rgb(255 255 255);
  --md-sys-color-tertiary-container: rgb(0 81 90);
  --md-sys-color-on-tertiary-container: rgb(255 255 255);
  --md-sys-color-error: rgb(81 26 19);
  --md-sys-color-on-error: rgb(255 255 255);
  --md-sys-color-error-container: rgb(118 54 45);
  --md-sys-color-on-error-container: rgb(255 255 255);
  --md-sys-color-background: rgb(244 250 251);
  --md-sys-color-on-background: rgb(22 29 29);
  --md-sys-color-surface: rgb(245 250 251);
  --md-sys-color-on-surface: rgb(0 0 0);
  --md-sys-color-surface-variant: rgb(219 228 230);
  --md-sys-color-on-surface-variant: rgb(0 0 0);
  --md-sys-color-outline: rgb(37 46 47);
  --md-sys-color-outline-variant: rgb(65 75 76);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(43 49 51);
  --md-sys-color-inverse-on-surface: rgb(255 255 255);
  --md-sys-color-inverse-primary: rgb(128 212 219);
  --md-sys-color-primary-fixed: rgb(0 82 87);
  --md-sys-color-on-primary-fixed: rgb(255 255 255);
  --md-sys-color-primary-fixed-dim: rgb(0 57 61);
  --md-sys-color-on-primary-fixed-variant: rgb(255 255 255);
  --md-sys-color-secondary-fixed: rgb(60 69 123);
  --md-sys-color-on-secondary-fixed: rgb(255 255 255);
  --md-sys-color-secondary-fixed-dim: rgb(37 46 99);
  --md-sys-color-on-secondary-fixed-variant: rgb(255 255 255);
  --md-sys-color-tertiary-fixed: rgb(0 81 90);
  --md-sys-color-on-tertiary-fixed: rgb(255 255 255);
  --md-sys-color-tertiary-fixed-dim: rgb(0 57 63);
  --md-sys-color-on-tertiary-fixed-variant: rgb(255 255 255);
  --md-sys-color-surface-dim: rgb(180 186 187);
  --md-sys-color-surface-bright: rgb(245 250 251);
  --md-sys-color-surface-container-lowest: rgb(255 255 255);
  --md-sys-color-surface-container-low: rgb(236 242 243);
  --md-sys-color-surface-container: rgb(222 227 229);
  --md-sys-color-surface-container-high: rgb(207 213 214);
  --md-sys-color-surface-container-highest: rgb(194 199 201);
}



================================================
FILE: App_Home/static/css/material-theme/light-mc.css
================================================
.light-medium-contrast {
  --md-sys-color-primary: rgb(0 61 65);
  --md-sys-color-surface-tint: rgb(0 105 111);
  --md-sys-color-on-primary: rgb(255 255 255);
  --md-sys-color-primary-container: rgb(22 121 127);
  --md-sys-color-on-primary-container: rgb(255 255 255);
  --md-sys-color-secondary: rgb(40 50 103);
  --md-sys-color-on-secondary: rgb(255 255 255);
  --md-sys-color-secondary-container: rgb(96 105 162);
  --md-sys-color-on-secondary-container: rgb(255 255 255);
  --md-sys-color-tertiary: rgb(0 60 68);
  --md-sys-color-on-tertiary: rgb(255 255 255);
  --md-sys-color-tertiary-container: rgb(24 120 132);
  --md-sys-color-on-tertiary-container: rgb(255 255 255);
  --md-sys-color-error: rgb(94 36 28);
  --md-sys-color-on-error: rgb(255 255 255);
  --md-sys-color-error-container: rgb(161 89 77);
  --md-sys-color-on-error-container: rgb(255 255 255);
  --md-sys-color-background: rgb(244 250 251);
  --md-sys-color-on-background: rgb(22 29 29);
  --md-sys-color-surface: rgb(245 250 251);
  --md-sys-color-on-surface: rgb(12 18 19);
  --md-sys-color-surface-variant: rgb(219 228 230);
  --md-sys-color-on-surface-variant: rgb(47 56 57);
  --md-sys-color-outline: rgb(75 84 86);
  --md-sys-color-outline-variant: rgb(101 111 112);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(43 49 51);
  --md-sys-color-inverse-on-surface: rgb(236 242 243);
  --md-sys-color-inverse-primary: rgb(128 212 219);
  --md-sys-color-primary-fixed: rgb(22 121 127);
  --md-sys-color-on-primary-fixed: rgb(255 255 255);
  --md-sys-color-primary-fixed-dim: rgb(0 94 100);
  --md-sys-color-on-primary-fixed-variant: rgb(255 255 255);
  --md-sys-color-secondary-fixed: rgb(96 105 162);
  --md-sys-color-on-secondary-fixed: rgb(255 255 255);
  --md-sys-color-secondary-fixed-dim: rgb(71 81 136);
  --md-sys-color-on-secondary-fixed-variant: rgb(255 255 255);
  --md-sys-color-tertiary-fixed: rgb(24 120 132);
  --md-sys-color-on-tertiary-fixed: rgb(255 255 255);
  --md-sys-color-tertiary-fixed-dim: rgb(0 94 104);
  --md-sys-color-on-tertiary-fixed-variant: rgb(255 255 255);
  --md-sys-color-surface-dim: rgb(194 199 201);
  --md-sys-color-surface-bright: rgb(245 250 251);
  --md-sys-color-surface-container-lowest: rgb(255 255 255);
  --md-sys-color-surface-container-low: rgb(239 245 246);
  --md-sys-color-surface-container: rgb(227 233 234);
  --md-sys-color-surface-container-high: rgb(216 222 223);
  --md-sys-color-surface-container-highest: rgb(205 211 212);
}



================================================
FILE: App_Home/static/css/material-theme/light.css
================================================
.light {
  --md-sys-color-primary: rgb(0 105 111);
  --md-sys-color-surface-tint: rgb(0 105 111);
  --md-sys-color-on-primary: rgb(255 255 255);
  --md-sys-color-primary-container: rgb(157 240 247);
  --md-sys-color-on-primary-container: rgb(0 79 84);
  --md-sys-color-secondary: rgb(81 91 146);
  --md-sys-color-on-secondary: rgb(255 255 255);
  --md-sys-color-secondary-container: rgb(222 224 255);
  --md-sys-color-on-secondary-container: rgb(57 67 121);
  --md-sys-color-tertiary: rgb(0 104 116);
  --md-sys-color-on-tertiary: rgb(255 255 255);
  --md-sys-color-tertiary-container: rgb(158 239 253);
  --md-sys-color-on-tertiary-container: rgb(0 79 88);
  --md-sys-color-error: rgb(144 75 64);
  --md-sys-color-on-error: rgb(255 255 255);
  --md-sys-color-error-container: rgb(255 218 212);
  --md-sys-color-on-error-container: rgb(115 52 42);
  --md-sys-color-background: rgb(244 250 251);
  --md-sys-color-on-background: rgb(22 29 29);
  --md-sys-color-surface: rgb(245 250 251);
  --md-sys-color-on-surface: rgb(23 29 30);
  --md-sys-color-surface-variant: rgb(219 228 230);
  --md-sys-color-on-surface-variant: rgb(63 72 74);
  --md-sys-color-outline: rgb(111 121 122);
  --md-sys-color-outline-variant: rgb(191 200 202);
  --md-sys-color-shadow: rgb(0 0 0);
  --md-sys-color-scrim: rgb(0 0 0);
  --md-sys-color-inverse-surface: rgb(43 49 51);
  --md-sys-color-inverse-on-surface: rgb(236 242 243);
  --md-sys-color-inverse-primary: rgb(128 212 219);
  --md-sys-color-primary-fixed: rgb(157 240 247);
  --md-sys-color-on-primary-fixed: rgb(0 32 34);
  --md-sys-color-primary-fixed-dim: rgb(128 212 219);
  --md-sys-color-on-primary-fixed-variant: rgb(0 79 84);
  --md-sys-color-secondary-fixed: rgb(222 224 255);
  --md-sys-color-on-secondary-fixed: rgb(11 21 75);
  --md-sys-color-secondary-fixed-dim: rgb(186 195 255);
  --md-sys-color-on-secondary-fixed-variant: rgb(57 67 121);
  --md-sys-color-tertiary-fixed: rgb(158 239 253);
  --md-sys-color-on-tertiary-fixed: rgb(0 31 36);
  --md-sys-color-tertiary-fixed-dim: rgb(130 211 224);
  --md-sys-color-on-tertiary-fixed-variant: rgb(0 79 88);
  --md-sys-color-surface-dim: rgb(213 219 220);
  --md-sys-color-surface-bright: rgb(245 250 251);
  --md-sys-color-surface-container-lowest: rgb(255 255 255);
  --md-sys-color-surface-container-low: rgb(239 245 246);
  --md-sys-color-surface-container: rgb(233 239 240);
  --md-sys-color-surface-container-high: rgb(227 233 234);
  --md-sys-color-surface-container-highest: rgb(222 227 229);
}



================================================
FILE: App_Home/static/js/scripts-HD.js
================================================
function toggleDropdown() {
    var content = document.getElementById("adminDropdownContent");
    var btn = document.getElementById("adminDropdownBtn");
    
    // 1. Cierra todos los dropdowns abiertos primero y remueve el estado 'active' del botÃƒÂ³n
    document.querySelectorAll('.dropdown-content.show').forEach(function(el) {
        if (el !== content) {
            el.classList.remove('show');
            el.style.height = '0'; // Cierra con animaciÃƒÂ³n
            // Busca el botÃƒÂ³n asociado para remover la clase 'active'
            const parentDropdown = el.closest('.dropdown');
            if (parentDropdown) {
                const associatedBtn = parentDropdown.querySelector('.dropbtn');
                if (associatedBtn) {
                    associatedBtn.classList.remove('active');
                }
            }
        }
    });

    // 2. Toggle del dropdown actual
    if (content.classList.contains('show')) {
        // Ocultar: Remueve las clases y pone la altura a 0
        content.classList.remove('show');
        content.style.height = '0';
        btn.classList.remove('active');
    } else {
        // Mostrar: AÃƒÂ±ade clases, calcula la altura y activa el botÃƒÂ³n
        content.classList.add('show');
        // Calcula la altura para que la animaciÃƒÂ³n funcione correctamente
        content.style.height = content.scrollHeight + 'px'; 
        btn.classList.add('active');
    }
}

// Opcional: Cerrar el menÃƒÂº si se hace clic fuera de ÃƒÂ©l
window.onclick = function(event) {
    // CAMBIO: Se asegura que si se hace clic fuera, todos los dropdowns se cierren
    if (!event.target.matches('.dropbtn') && !event.target.matches('.dropbtn i')) {
        document.querySelectorAll('.dropdown-content.show').forEach(function(content) {
            content.classList.remove("show");
            content.style.height = '0';
            
            // Busca el botÃƒÂ³n asociado para remover la clase 'active'
            const parentDropdown = content.closest('.dropdown');
            if (parentDropdown) {
                const associatedBtn = parentDropdown.querySelector('.dropbtn');
                if (associatedBtn) {
                    associatedBtn.classList.remove('active');
                }
            }
        });
    }
}


================================================
FILE: App_Home/static/js/scripts-login.js
================================================
const container = document.querySelector(".container");
const registerBtn = document.querySelector(".register-btn");
const loginBtn = document.querySelector(".login-btn");

registerBtn.addEventListener("click", () => {
    container.classList.add("active");
});

loginBtn.addEventListener("click", () => {
    container.classList.remove("active");
});

// --- CÃ“DIGO DE DESAPARICIÃ“N ---

document.addEventListener('DOMContentLoaded', function() {
    // Selecciona todos los mensajes de alerta dentro del contenedor
    const alerts = document.querySelectorAll('.message-container .alert');
    const DURATION = 9000; // 9 segundos para que el mensaje desaparezca
    
    // *** LÃNEA DE DEBUGGING: Abrir Consola (F12) para confirmar que se ejecuta. ***
    console.log(`[DEBUG] Alertas encontradas: ${alerts.length}`);
    // *************************************************************************

    if (alerts.length > 0) {
        alerts.forEach(alert => {
            // 1. Inicia el temporizador de desapariciÃ³n (5 segundos)
            setTimeout(() => {
                // AÃ±ade la clase 'hide' para iniciar la transiciÃ³n CSS (opacidad y desplazamiento)
                alert.classList.add('hide');

                // 2. Opcional: Elimina el elemento del DOM despuÃ©s de que termine la transiciÃ³n
                // El tiempo (500ms) debe ser igual a la duraciÃ³n de la transiciÃ³n en styles-login.css
                setTimeout(() => {
                    alert.remove();
                }, 500); 
            }, DURATION); 
        });
    }
});


================================================
FILE: App_Home/templates/completar_perfil.html
================================================
{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
<div class="perfil-container-wrapper"> 
    <div class="perfil-container"> 
        {% if messages %}
            <div class="mensajes-django-container">
                {% for message in messages %}
                    <div class="alerta alerta-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <h1>Completar Datos de Perfil</h1>
        <p>Casi terminas el registro, **{{ usuario.username }}**. Por favor, proporciona tus datos completos.</p>
        
        <form method="POST">
            {% csrf_token %}
            
            <h2>InformaciÃƒÂ³n Personal</h2>
            
            <div class="form-row"> 
                <div class="form-group">
                    {{ formulario.first_name.label_tag }}
                    {{ formulario.first_name }}
                    {{ formulario.first_name.errors }}
                </div>
                <div class="form-group">
                    {{ formulario.last_name.label_tag }}
                    {{ formulario.last_name }}
                    {{ formulario.last_name.errors }}
                </div>
            </div>

            <div class="form-group">
                {{ formulario.cedula.label_tag }}
                {{ formulario.cedula }}
                {{ formulario.cedula.errors }}
            </div>

            <h2>AsignaciÃƒÂ³n de Rol</h2>
            <div class="form-group">
                {{ formulario.rol.label_tag }}
                {{ formulario.rol }}
                {{ formulario.rol.errors }}
            </div>
            <div class="form-group">
                {{ formulario.tower.label_tag }}
                {{ formulario.tower }}
                {{ formulario.tower.errors }}
            </div>

            <h2>Optar por Roles Secundarios (Opcional)</h2>
            <p class="text-muted">Marca si deseas colaborar con roles de gestiÃƒÂ³n especÃƒÂ­ficos.</p>
            <div class="checkbox-group">
                <div class="form-check">
                    {{ formulario.es_admin_basura }} {{ formulario.es_admin_basura.label_tag }}
                </div>
                <div class="form-check">
                    {{ formulario.es_admin_clap }} {{ formulario.es_admin_clap.label_tag }}
                </div>
                <div class="form-check">
                    {{ formulario.es_admin_bombonas }} {{ formulario.es_admin_bombonas.label_tag }}
                </div>
            </div>

            <button type="submit" class="btn mt-4">Guardar y Acceder</button>
        </form>
    </div>
</div>
{% endblock content %}


================================================
FILE: App_Home/templates/homeDashboard.html
================================================
{% extends 'layouts/base.html' %}
{% load static %}
{% block content %}

<div class="dashboard-container">
    <header class="dashboard-header">
        <h1>Balcones de Paraguana I</h1>
        
        {% if request.user.is_authenticated %}
            <p class="user-info">
                Bienvenido, **{{ request.user.username }}** | 
                {% if request.user.rol == 'LDG' %}
                    **Rol: LÃƒÂ­der General**
                {% elif request.user.rol == 'LDT' and request.user.tower %}
                    **LÃƒÂ­der de la Torre {{ request.user.tower.nombre }}**
                {% else %}\
                    **LÃƒÂ­der (Pendiente de AsignaciÃƒÂ³n)**
                {% endif %}
            </p>
        {% else %}
            <p class="user-info">Modo Espectador</p>
        {% endif %}
    </header>

    <main class="botones-grid">
        
        <div class="dropdown">
            <button class="boton-principal dropbtn" id="adminDropdownBtn" onclick="toggleDropdown()">
                <i class="fas fa-chart-line"></i>
                AdministraciÃƒÂ³n de Ingresos y Egresos
            </button>
            <div class="dropdown-content" id="adminDropdownContent">
                <a href="{% url 'ver_finanzas' categoria_slug='condominio' %}">Condominio</a>
                <a href="{% url 'ver_finanzas' categoria_slug='basura' %}">Cuarto de Basura</a>
            </div>
        </div>

        <a href="#bolsa-clap" class="boton-principal">
            <i class="fas fa-shopping-bag"></i>
            Bolsa Clap
        </a>

        <a href="#bombona" class="boton-principal">
            <i class="fas fa-fire"></i>
            Bombona
        </a>

        <a href="#carta-residencia" class="boton-principal">
            <i class="fas fa-file-alt"></i>
            Carta de Residencia
        </a>
        
        {% if request.user.is_authenticated and request.user.rol == 'LDT' or request.user.is_authenticated and request.user.rol == 'LDG' %}
            <a href="#censo" class="boton-principal">
                <i class="fas fa-users"></i>
                Censo
            </a>
        {% endif %}

        {% if request.user.is_authenticated and request.user.rol == 'LDG' %}
            <a href="{% url 'lider_general:lista_usuarios' %}" class="boton-principal">
                <i class="fas fa-user-cog"></i>
                GestiÃƒÂ³n de Usuarios
            </a>
        {% endif %}


        {% if request.user.is_authenticated %}
            <a href="{% url 'url_logout' %}" class="boton-principal logout-button">
                <i class="fas fa-sign-out-alt"></i>
                Cerrar SesiÃƒÂ³n
            </a>
        {% else %}
            <a href="{% url 'url_login' %}" class="boton-principal">
                <i class="fas fa-sign-in-alt"></i>
                Iniciar SesiÃƒÂ³n
            </a>
        {% endif %}
    </main>
</div>
{% endblock content %}


================================================
FILE: App_Home/templates/login.html
================================================
{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}

    <div class="message-container">
        {% if messages %}
            {% for message in messages %}
                <div id="msg-{{ forloop.counter }}" class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    </div>
    <div class="container" id="container">
    
    <div class="form-box login">
        <form method="POST" action="{% url 'url_login' %}">
            {% csrf_token %} 
            <h1>Login</h1>
            
            <div class="input-box">
                <input type="text" placeholder="Username" required name="username">
                <i class="bx bxs-user"></i>
            </div>
            <div class="input-box">
                <input type="password" placeholder="Password" required name="password">
                <i class="bx bxs-lock-alt"></i>
            </div>
            
            <div class="forgot-link">
                <a href="#">Forgot Password?</a>
            </div>
            
            <button type="submit" class="btn">Login</button>
            <div class="back-link-container"> 
                <a href="{% url 'url_dashboard' %}">Volver al Inicio</a>
            </div>
        </form>
    </div>

    
    <div class="form-box register">
        <form method="POST" action="{% url 'url_registro' %}">
            {% csrf_token %}
            <h1>Registration</h1>
            
            <div class="input-box">
                <input type="text" placeholder="Username" required name="username">
                <i class="bx bxs-user"></i>
            </div>
            <div class="input-box">
                <input type="email" placeholder="Email" required name="email">
                <i class="bx bxs-envelope"></i>
            </div>
            <div class="input-box">
                <input type="password" placeholder="Password" required name="password1">
                <i class="bx bxs-lock-alt"></i>
            </div>
             <div class="input-box">
                <input type="password" placeholder="Confirmar Password" required name="password2">
                <i class="bx bxs-lock-alt"></i>
            </div>
            <button type="submit" class="btn">Register</button>
        </form>
    </div>

    <div class="toggle-box">
        <div class="toggle-panel toggle-left">
            <h1>Hello, Welcome!</h1>
            <p>Don't have an account?</p>
            <button class="btn register-btn">Register</button>
        </div>
        <div class="toggle-panel toggle-right">
            <h1>Welcome Back!</h1>
            <p>Already have an account?</p>
            <button class="btn login-btn">Login</button>
        </div>
    </div>
    
</div>

{% endblock content %}


================================================
FILE: App_Home/templates/finanzas/listado_movimientos.html
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8d in position 3141: character maps to <undefined>


================================================
FILE: App_Home/templates/layouts/base.html
================================================
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Carga Archivos Estaticos -->
    {% load static %}
    <!-- Configuracion basica del documento HTML -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Estilos y Funciones asociados al Navbar -->
    <link rel="stylesheet" href="{% static 'css/styles-navbar.css' %}" />
    <!-- Estilos y Funciones asociados al Login-->
    <link rel="stylesheet" href="{% static 'css/styles-login.css' %}" />
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <script src="{% static 'js/scripts-login.js' %}" defer></script>
    <!-- Estilos y Funciones asociados al homeDashboard -->
    <link rel="stylesheet" href="{% static 'css/styles-HD.css' %}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="{% static 'js/scripts-HD.js' %}" defer></script>
    <!-- Estilos y Funciones asociados al completar perfil -->
    <link rel="stylesheet" href="{% static 'css/styles-perfil.css' %}">
    <!-- Estilos y Funciones asociados a Condominio y Cuarto de Basura -->
    <link rel="stylesheet" href="{% static 'css/styles-listado.css' %}">
    <!-- Estilos y Funciones de Gestions de Usuarios -->
    <link rel="stylesheet" href="{% static 'css/styles-lidergeneral.css' %}">
    <!-- Titulo General de la Pagina -->
    <title>Balcones de Paraguana I</title>
</head>

<body class="light" {% block body_attributes %}{% endblock %}>
    <!-- Bloque de Django para insertar el contenido del navbar. -->
    <!-- Este bloque se define en la plantilla que extiende a esta (navbar.html). -->
    {% block navbar %}
    {% endblock navbar %}

    <!-- Bloque de Django para insertar el contenido del login. -->
    <!-- Este bloque se define en la plantilla que extiende a esta (login.html). -->
    {% block content %}
    {% endblock content %}
</body>

</html>


================================================
FILE: App_Home/templates/layouts/navbar.html
================================================
{% extends 'layouts/base.html' %} 
{% block navbar %} 
{% load static %}

<!-- Barra de NavegaciÃ³n -->
<nav id="bottom-navbar">
    
    <a href="{% url 'url_dashboard' %}" class="nav-item" title="Inicio">
        <span class="icon">ðŸ </span>
        <span class="label">Inicio</span>
    </a>
    
    <a href="{% url 'ver_finanzas' categoria_slug='condominio' %}" class="nav-item" title="Condominio">
        <span class="icon">ðŸ¢</span>
        <span class="label">Condominio</span>
    </a>
    
    <a href="{% url 'ver_finanzas' categoria_slug='basura' %}" class="nav-item" title="Basura">
        <span class="icon">ðŸ—‘ï¸</span>
        <span class="label">Basura</span>
    </a>

    <a href="#" class="nav-item" title="CLAP">
        <span class="icon">ðŸ“¦</span>
        <span class="label">CLAP</span>
    </a>

    <a href="#" class="nav-item" title="Bombona">
        <span class="icon">ðŸ”¥</span>
        <span class="label">Gas</span>
    </a>

    {% if request.user.is_authenticated and request.user.rol == 'LDT' or request.user.is_authenticated and request.user.rol == 'LDG' %}
        <a href="#" class="nav-item" title="Censo">
            <span class="icon">ðŸ‘¥</span>
            <span class="label">Censo</span>
        </a>
    {% endif %}

    {% if request.user.is_authenticated and request.user.rol == 'LDG' %}
        <a href="{% url 'lider_general:lista_usuarios' %}" class="nav-item" title="Usuarios">
            <span class="icon">ðŸ‘¤</span>
            <span class="label">Usuarios</span>
        </a>
    {% endif %}
</nav>


<!-- Contenedor principal del contenido de la pÃ¡gina -->
{% block main %} 
{% endblock main %} 

{% endblock navbar %}


================================================
FILE: App_LiderGeneral/__init__.py
================================================
[Empty file]


================================================
FILE: App_LiderGeneral/admin.py
================================================
from django.contrib import admin

# Register your models here.



================================================
FILE: App_LiderGeneral/apps.py
================================================
from django.apps import AppConfig


class AppLidergeneralConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'App_LiderGeneral'



================================================
FILE: App_LiderGeneral/forms.py
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8d in position 1776: character maps to <undefined>


================================================
FILE: App_LiderGeneral/models.py
================================================
from django.db import models

# Create your models here.



================================================
FILE: App_LiderGeneral/tests.py
================================================
from django.test import TestCase

# Create your tests here.



================================================
FILE: App_LiderGeneral/urls.py
================================================
# App_LiderGeneral/urls.py

from django.urls import path
from . import views

# Define un 'namespace' para evitar conflictos de nombres de rutas
app_name = 'lider_general'

urlpatterns = [
    # 1. LISTADO DE USUARIOS (RUTA PRINCIPAL)
    path('usuarios/', views.ListaUsuariosView.as_view(), name='lista_usuarios'),
    
    # 2. CREACIÃƒâ€œN DE USUARIOS
    path('usuarios/crear/', views.CrearUsuarioView.as_view(), name='crear_usuario'),
    
    # 3. EDICIÃƒâ€œN DE USUARIOS
    path('usuarios/editar/<int:pk>/', views.EditarUsuarioView.as_view(), name='editar_usuario'),
    
    # 4. ELIMINACIÃƒâ€œN DE USUARIOS
    path('usuarios/eliminar/<int:pk>/', views.EliminarUsuarioView.as_view(), name='eliminar_usuario'),

    # Condominio
    path('condominio/ingresar/', views.RegistrarIngresoCondominioGeneralView.as_view(), name='ingresar_condominio_general'),
    path('condominio/egresar/', views.RegistrarEgresoCondominioGeneralView.as_view(), name='egresar_condominio_general'),
    
    # Cuarto de Basura
    path('basura/ingresar/', views.RegistrarIngresoBasuraGeneralView.as_view(), name='ingresar_basura_general'),
    path('basura/egresar/', views.RegistrarEgresoBasuraGeneralView.as_view(), name='egresar_basura_general'),
]


================================================
FILE: App_LiderGeneral/views.py
================================================
# App_LiderGeneral/views.py

from django.contrib.auth.mixins import AccessMixin, LoginRequiredMixin, UserPassesTestMixin
from django.views.generic import ListView, CreateView, UpdateView, DeleteView
from django.urls import reverse_lazy
from App_Home.models import CustomUser, MovimientoFinanciero
from django.shortcuts import redirect
from django.contrib import messages
from django.contrib.auth import get_user_model
from App_LiderTorre.views import BaseMovimientoCreateView 
from .forms import ( FormularioAdminUsuario,
    IngresoCondominioGeneralForm, EgresoCondominioGeneralForm, 
    IngresoBasuraGeneralForm, EgresoBasuraGeneralForm
)

# Create your views here.

# ******************************************************************
# MIXIN DE AUTORIZACIÃƒâ€œN: Restringe el acceso solo a LÃƒÂ­deres Generales
# ******************************************************************
class LiderGeneralRequiredMixin(AccessMixin):
    """Verifica que el usuario actual tenga el rol de Lider General."""
    def dispatch(self, request, *args, **kwargs):
        # Aseguramos que el usuario estÃƒÂ© autenticado
        if not request.user.is_authenticated:
            return self.handle_no_permission()
        
        # Usamos la constante del modelo para la comparaciÃƒÂ³n
        if request.user.rol != CustomUser.ROL_LIDER_GENERAL:
            messages.error(request, "No tienes permiso para acceder a esta secciÃƒÂ³n administrativa.")
            # Redirigir al dashboard si no tiene el rol
            return redirect('homeDashboard') 
            
        return super().dispatch(request, *args, **kwargs)

# ******************************************************************
# 1. LISTADO DE USUARIOS (READ)
# ******************************************************************
class ListaUsuariosView(LoginRequiredMixin, LiderGeneralRequiredMixin, ListView):
    model = CustomUser
    template_name = 'lider_general/lista_usuarios.html' 
    context_object_name = 'usuarios'
    ordering = ['username'] 

# ******************************************************************
# 2. CREACIÃƒâ€œN DE USUARIOS (CREATE)
# Nota: La creaciÃƒÂ³n de usuarios por aquÃƒÂ­ requiere asignar una contraseÃƒÂ±a.
# Si prefieres que se registren por App_Home, puedes omitir esta vista.
# AquÃƒÂ­ se usa un modelo simple sin manejo de contraseÃƒÂ±a.
# ******************************************************************
class CrearUsuarioView(LoginRequiredMixin, LiderGeneralRequiredMixin, CreateView):
    model = CustomUser
    form_class = FormularioAdminUsuario 
    template_name = 'lider_general/usuario_form.html'
    success_url = reverse_lazy('lider_general:lista_usuarios')
    
    def form_valid(self, form):
        # RecomendaciÃƒÂ³n: Si quieres crear el usuario con contraseÃƒÂ±a, 
        # debes usar un formulario de creaciÃƒÂ³n de usuario adecuado (ej: UserCreationForm)
        # o establecer una contraseÃƒÂ±a temporal hasheada aquÃƒÂ­.
        messages.success(self.request, f"Usuario '{form.instance.username}' creado con ÃƒÂ©xito.")
        return super().form_valid(form)

# ******************************************************************
# 3. EDICIÃƒâ€œN DE USUARIOS (UPDATE)
# ******************************************************************
class EditarUsuarioView(LoginRequiredMixin, LiderGeneralRequiredMixin, UpdateView):
    model = CustomUser
    form_class = FormularioAdminUsuario 
    template_name = 'lider_general/usuario_form.html'
    success_url = reverse_lazy('lider_general:lista_usuarios')
    
    def form_valid(self, form):
        messages.success(self.request, f"Usuario '{form.instance.username}' editado con ÃƒÂ©xito.")
        return super().form_valid(form)

# ******************************************************************
# 4. ELIMINACIÃƒâ€œN DE USUARIOS (DELETE)
# ******************************************************************
class EliminarUsuarioView(LoginRequiredMixin, LiderGeneralRequiredMixin, DeleteView):
    model = CustomUser
    template_name = 'lider_general/usuario_confirm_delete.html'
    success_url = reverse_lazy('lider_general:lista_usuarios')
    context_object_name = 'usuario'

    def form_valid(self, form):
        messages.success(self.request, f"Usuario '{self.object.username}' eliminado con ÃƒÂ©xito.")
        return super().form_valid(form)
    
# --- Mixin de Permisos ---

class LiderGeneralOrAdminBasuraRequiredMixin(UserPassesTestMixin):
    """Permite el acceso solo a LÃƒÂ­der General o a un Lider con rol de Admin Basura."""
    def test_func(self):
        user = self.request.user
        return user.rol == CustomUser.ROL_LIDER_GENERAL or user.es_admin_basura

class LiderGeneralRequiredMixin(UserPassesTestMixin):
    """Permite el acceso solo a LÃƒÂ­der General."""
    def test_func(self):
        user = self.request.user
        return user.rol == CustomUser.ROL_LIDER_GENERAL

# --- Vistas de Movimientos Financieros (LÃƒÂ­der General) ---

# Condominio (Requiere ser LDG)
class RegistrarIngresoCondominioGeneralView(LiderGeneralRequiredMixin, BaseMovimientoCreateView):
    form_class = IngresoCondominioGeneralForm
    TIPO_MOVIMIENTO = 'Ingreso'
    CATEGORIA_MOVIMIENTO = 'Condominio'
    MONTO_FIELD = 'monto_condominio'

class RegistrarEgresoCondominioGeneralView(LiderGeneralRequiredMixin, BaseMovimientoCreateView):
    form_class = EgresoCondominioGeneralForm
    TIPO_MOVIMIENTO = 'Egreso'
    CATEGORIA_MOVIMIENTO = 'Condominio'
    MONTO_FIELD = 'monto_condominio'

# Cuarto de Basura (Ingreso: Requiere ser LDG)
class RegistrarIngresoBasuraGeneralView(LiderGeneralRequiredMixin, BaseMovimientoCreateView):
    form_class = IngresoBasuraGeneralForm
    TIPO_MOVIMIENTO = 'Ingreso'
    CATEGORIA_MOVIMIENTO = 'Cuarto de Basura'
    MONTO_FIELD = 'monto_basura'

# Cuarto de Basura (Egreso: Requiere ser LDG O Admin Basura)
# Esta vista permite realizar egresos de basura en cualquier torre (se selecciona en el form)
class RegistrarEgresoBasuraGeneralView(LiderGeneralOrAdminBasuraRequiredMixin, BaseMovimientoCreateView):
    form_class = EgresoBasuraGeneralForm
    TIPO_MOVIMIENTO = 'Egreso'
    CATEGORIA_MOVIMIENTO = 'Cuarto de Basura'
    MONTO_FIELD = 'monto_basura'
    


================================================
FILE: App_LiderGeneral/templates/lider_general/lista_usuarios.html
================================================
{% extends 'layouts/navbar.html' %}

{% load static %}

{% block title %}AdministraciÃƒÂ³n de Usuarios{% endblock %}

{% block content %}
<div class="user-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>GestiÃƒÂ³n de Usuarios</h2>
        <a href="{% url 'lider_general:crear_usuario' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Crear Nuevo Usuario
        </a>
    </div>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Usuario</th>
                    <th>Nombre Completo</th>
                    <th>Rol Principal</th>
                    <th>Torre</th>
                    <th>Activo</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for usuario in usuarios %}
                <tr>
                    <td>{{ usuario.username }}</td>
                    <td>{{ usuario.get_full_name|default:'N/A' }}</td>
                    <td>{{ usuario.get_rol_display }}</td>
                    <td>{{ usuario.tower.nombre|default:'N/A' }}</td>
                    <td>
                        {% if usuario.is_active %}
                            <span class="badge bg-success">SÃƒÂ­</span>
                        {% else %}
                            <span class="badge bg-danger">No</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'lider_general:editar_usuario' usuario.pk %}" class="btn btn-sm btn-info" title="Editar">
                            <i class="fas fa-edit"></i>
                            Editar
                        </a>
                        <a href="{% url 'lider_general:eliminar_usuario' usuario.pk %}" class="btn btn-sm btn-danger" title="Eliminar">
                            <i class="fas fa-trash"></i>
                            Eliminar
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center">No hay usuarios registrados.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}


================================================
FILE: App_LiderGeneral/templates/lider_general/usuario_confirm_delete.html
================================================
{% extends 'layouts/base.html' %}

{% block title %}Confirmar EliminaciÃƒÂ³n{% endblock %}

{% block content %}
<div class="user-container">
    <h2>Confirmar EliminaciÃƒÂ³n</h2>
    <hr>
    
    <div class="alert alert-warning" role="alert">
        <h4 class="alert-heading">Ã‚Â¡Advertencia!</h4>
        <p>EstÃƒÂ¡s a punto de eliminar al usuario **{{ usuario.username }}** (`{{ usuario.get_rol_display }}`). Esta acciÃƒÂ³n es **irreversible**.</p>
    </div>
    
    <p>Ã‚Â¿EstÃƒÂ¡s seguro de que deseas eliminar a **{{ usuario.first_name }} {{ usuario.last_name }}**?</p>
    
    <form method="post" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger me-2">
            <i class="fas fa-trash"></i> Confirmar EliminaciÃƒÂ³n
        </button>
    </form>
    
    <a href="{% url 'lider_general:lista_usuarios' %}" class="btn btn-secondary">
        <i class="fas fa-times"></i> Cancelar
    </a>
</div>
{% endblock %}


================================================
FILE: App_LiderGeneral/templates/lider_general/usuario_form.html
================================================
{% extends 'layouts/base.html' %}

{% block title %}
    {% if form.instance.pk %}Editar Usuario: {{ form.instance.username }}{% else %}Crear Nuevo Usuario{% endif %}
{% endblock %}

{% block content %}
<div class="user-container">
    <h2>
        {% if form.instance.pk %}Editar Usuario: {{ form.instance.username }}{% else %}Crear Nuevo Usuario{% endif %}
    </h2>
    <hr>
    
    <form method="post">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}

        {# Grid de 2 columnas para los campos #}
        <div class="row g-3">
            {% for field in form %}
            <div class="col-md-6">
                <div class="form-group">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    {{ field }}
                    {% for error in field.errors %}
                        <div class="text-danger small">{{ error }}</div>
                    {% endfor %}
                    {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="mt-4">
            <button type="submit" class="btn btn-success me-2">
                <i class="fas fa-save"></i> Guardar Cambios
            </button>
            <a href="{% url 'lider_general:lista_usuarios' %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
            </a>
        </div>
    </form>
</div>
{% endblock %}


================================================
FILE: App_LiderTorre/__init__.py
================================================
[Empty file]


================================================
FILE: App_LiderTorre/admin.py
================================================
from django.contrib import admin

# Register your models here.



================================================
FILE: App_LiderTorre/apps.py
================================================
from django.apps import AppConfig


class AppLidertorreConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'App_LiderTorre'



================================================
FILE: App_LiderTorre/forms.py
================================================
# App_LiderTorre/forms.py

from django import forms
# Importa MovimientoFinanciero desde App_Home
from App_Home.models import MovimientoFinanciero 

class MovimientoFormBase(forms.ModelForm):
    """Formulario base para Ingresos y Egresos. Solo muestra fecha y descripciÃƒÂ³n."""
    # --- NUEVO CAMPO: Tasa BCV ---
    # Lo definimos de forma explÃƒÂ­cita para controlar el widget, el step y la precisiÃƒÂ³n.
    tasa_bcv = forms.DecimalField(
        max_digits=10, 
        decimal_places=4, 
        min_value=0.0001, # La tasa debe ser un valor positivo
        label='Tasa BCV (Bs/USD)',
        widget=forms.NumberInput(attrs={'class': 'form-control', 'step': '0.0001', 'required': 'required'})
    )
    # -----------------------------
    class Meta:
        model = MovimientoFinanciero
        # Excluimos los campos que la vista auto-asignarÃƒÂ¡
        exclude = ('tipo', 'categoria', 'tower', 'creado_por', 'monto_basura', 'monto_condominio')
        
        fields = ['fecha', 'descripcion', 'tasa_bcv'] 

        widgets = {
            # Usamos la clase 'form-control' para aplicar los estilos de styles-lidergeneral.css
            'fecha': forms.DateInput(attrs={'type': 'date', 'class': 'form-control'}),
            'descripcion': forms.Textarea(attrs={'class': 'form-control', 'rows': 3}),
        }
        
        labels = {
            'fecha': 'Fecha del Movimiento',
            'descripcion': 'DescripciÃƒÂ³n / Detalle del Pago',
        }

# --- Formularios EspecÃƒÂ­ficos para Condominio ---

class IngresoCondominioForm(MovimientoFormBase):
    # Campo personalizado para el monto (se usarÃƒÂ¡ en el modelo)
    monto_condominio = forms.DecimalField(
        max_digits=10, 
        decimal_places=2, 
        min_value=0.01, 
        label='Monto Ingreso Condominio (Bs)',
        widget=forms.NumberInput(attrs={'class': 'form-control', 'step': '0.01'})
    )

    class Meta(MovimientoFormBase.Meta):
        # Campos a mostrar en el formulario de ingreso de condominio
        fields = MovimientoFormBase.Meta.fields + ['monto_condominio']

class EgresoCondominioForm(MovimientoFormBase):
    monto_condominio = forms.DecimalField(
        max_digits=10, 
        decimal_places=2, 
        min_value=0.01, 
        label='Monto Egreso Condominio (Bs)',
        widget=forms.NumberInput(attrs={'class': 'form-control', 'step': '0.01'})
    )

    class Meta(MovimientoFormBase.Meta):
        fields = MovimientoFormBase.Meta.fields + ['monto_condominio']

# --- Formularios EspecÃƒÂ­ficos para Cuarto de Basura ---

class IngresoBasuraForm(MovimientoFormBase):
    monto_basura = forms.DecimalField(
        max_digits=10, 
        decimal_places=2, 
        min_value=0.01, 
        label='Monto Ingreso Cuarto de Basura (Bs)',
        widget=forms.NumberInput(attrs={'class': 'form-control', 'step': '0.01'})
    )

    class Meta(MovimientoFormBase.Meta):
        fields = MovimientoFormBase.Meta.fields + ['monto_basura']



================================================
FILE: App_LiderTorre/mixins.py
================================================
# App_LiderTorre/mixins.py

from django.contrib.auth.mixins import AccessMixin
from django.shortcuts import redirect
from django.urls import reverse_lazy
from App_Home.models import CustomUser
from django.contrib import messages

class LiderTorreRequiredMixin(AccessMixin):
    """
    Mixin para asegurar que el usuario tenga el rol de LÃƒÂ­der de Torre (LDT) o
    LÃƒÂ­der General (LDG).
    """
    def dispatch(self, request, *args, **kwargs):
        # Verifica si el usuario estÃƒÂ¡ autenticado
        if not request.user.is_authenticated:
            # Redirige a la URL de inicio de sesiÃƒÂ³n
            return self.handle_no_permission() 
        
        # Define los roles permitidos
        roles_permitidos = [CustomUser.ROL_LIDER_TORRE, CustomUser.ROL_LIDER_GENERAL]
        
        # Verifica si el rol del usuario estÃƒÂ¡ en los roles permitidos
        if request.user.rol not in roles_permitidos:
            messages.error(request, "No tienes permiso para registrar movimientos.")
            # Redirigir al dashboard principal si no tiene el rol
            return redirect(reverse_lazy('url_dashboard')) 

        return super().dispatch(request, *args, **kwargs)


================================================
FILE: App_LiderTorre/models.py
================================================
from django.db import models

# Create your models here.



================================================
FILE: App_LiderTorre/tests.py
================================================
from django.test import TestCase

# Create your tests here.



================================================
FILE: App_LiderTorre/urls.py
================================================
# App_LiderTorre/urls.py

from django.urls import path
from . import views

# Define un 'namespace' para evitar conflictos de nombres de rutas
app_name = 'lider_torre'

urlpatterns = [
    # Condominio
    path('condominio/ingresar/', views.RegistrarIngresoCondominioView.as_view(), name='ingresar_condominio'),
    path('condominio/egresar/', views.RegistrarEgresoCondominioView.as_view(), name='egresar_condominio'),
    
    # Cuarto de Basura
    path('basura/ingresar/', views.RegistrarIngresoBasuraView.as_view(), name='ingresar_basura'),
]


================================================
FILE: App_LiderTorre/views.py
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x8d in position 4830: character maps to <undefined>


================================================
FILE: App_LiderTorre/templates/lider_torre/movimiento_form.html
================================================
{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}{{ titulo }}{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>{{ titulo }}</h2>
    <hr>
    
    {% if messages %}
        <div class="mensajes-django-container">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <form method="post">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}
        
        {# Utilizamos la cuadrÃƒÂ­cula responsive row g-3 y col-md-6/12 #}
        <div class="row g-3">

            {% if form.tower %}
                <div class="col-md-12">
                    <div class="form-group">
                        {% if form.tower.field.required %}
                            <label for="{{ form.tower.id_for_label }}" class="form-label">{{ form.tower.label }}</label>
                            {{ form.tower }}
                            {% for error in form.tower.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                            {% if form.tower.help_text %}
                                <small class="form-text text-muted">{{ form.tower.help_text }}</small>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            {% endif %}
            
            {# Fecha y DescripciÃƒÂ³n (Ancho completo en todas las pantallas) #}
            {% for field in form %}
                {% if field.name == 'fecha' or field.name == 'descripcion' %}
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                            {{ field }}
                            {% for error in field.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

            {# Campo de Tasa BCV y Montos (Mitad de ancho en desktop) #}
            {% for field in form %}
                {% if field.name == 'tasa_bcv' or field.name == 'monto_condominio' or field.name == 'monto_basura' %}
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                            {{ field }}
                            {% for error in field.errors %}
                                <div class="text-danger small">{{ error }}</div>
                            {% endfor %}
                            {% if field.help_text %}
                                <small class="form-text text-muted">{{ field.help_text }}</small>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}

        </div>

        <div class="mt-4">
            <button type="submit" class="btn btn-primary me-2">
                <i class="fas fa-save"></i> Registrar Movimiento
            </button>
            <a href="{% url 'url_dashboard' %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
            </a>
        </div>
    </form>
</div>
{% endblock %}


================================================
FILE: Community_Service/__init__.py
================================================
[Empty file]


================================================
FILE: Community_Service/asgi.py
================================================
"""
ASGI config for Community_Service project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'Community_Service.settings')

application = get_asgi_application()



================================================
FILE: Community_Service/settings.py
================================================
# "Community_Service/settings.py" (Fragmento completo que incluye las configuraciones de autenticaciÃƒÂ³n)

"""
Django settings for Community_Service project.

Generated by 'django-admin startproject' using Django 5.2.7.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.2/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-ign2m==4igmt%9@n_#a@1^8$p7n&9lv+g-vwkm(-*2oh39ne-!'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'App_Home',
    'App_LiderTorre', # Asumo que ya la tienes instalada
    'App_LiderGeneral', # Asumo que ya la tienes instalada
    # ... otras apps si las tienes
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'Community_Service.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'], # Asumo que tienes una carpeta de templates global
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'Community_Service.wsgi.application'


# Database
# https://docs.djangoproject.com/en/5.2/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}


# Password validation
# https://docs.djangoproject.com/en/5.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/5.2/topics/i18n/

LANGUAGE_CODE = 'es-ve' # Establecido a Venezuela por contexto
TIME_ZONE = 'America/Caracas' # Establecido a Caracas por contexto

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.2/howto/static-files/

STATIC_URL = 'static/'

# Default primary key field type
# https://docs.djangoproject.com/en/5.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

# ----------------------------------------------------
# CONFIGURACIÃƒâ€œN DE AUTENTICACIÃƒâ€œN PERSONALIZADA
# ----------------------------------------------------

# El modelo de usuario personalizado que se usa en el proyecto
AUTH_USER_MODEL = 'App_Home.CustomUser'

# URL a la que se redirige cuando se requiere inicio de sesiÃƒÂ³n (debe ser la misma que tu path en urls.py)
LOGIN_URL = '/login/' # <--- Ã‚Â¡CORRECCIÃƒâ€œN!

# URL a la que se redirige a los usuarios despuÃƒÂ©s de iniciar sesiÃƒÂ³n con ÃƒÂ©xito
LOGIN_REDIRECT_URL = '/' 

# URL a la que se redirige a los usuarios despuÃƒÂ©s de cerrar sesiÃƒÂ³n (puedes ajustarla)
LOGOUT_REDIRECT_URL = '/login/'


================================================
FILE: Community_Service/urls.py
================================================
"""
URL configuration for Community_Service project.

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/5.2/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import include, path

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('App_Home.urls')),
    path('lider/', include('App_LiderTorre.urls')),
    path('general/', include('App_LiderGeneral.urls')),
]



================================================
FILE: Community_Service/wsgi.py
================================================
"""
WSGI config for Community_Service project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'Community_Service.settings')

application = get_wsgi_application()


